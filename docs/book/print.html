<!DOCTYPE HTML>
<html lang="en" class="light sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title></title>
        <meta name="robots" content="noindex">


        <!-- Custom HTML head -->

        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" id="highlight-css" href="highlight.css">
        <link rel="stylesheet" id="tomorrow-night-css" href="tomorrow-night.css">
        <link rel="stylesheet" id="ayu-highlight-css" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->


        <!-- Provide site root and default themes to javascript -->
        <script>
            const path_to_root = "";
            const default_light_theme = "light";
            const default_dark_theme = "navy";
            window.path_to_searchindex_js = "searchindex.js";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="toc.js"></script>
    </head>
    <body>
    <div id="mdbook-help-container">
        <div id="mdbook-help-popup">
            <h2 class="mdbook-help-title">Keyboard shortcuts</h2>
            <div>
                <p>Press <kbd>←</kbd> or <kbd>→</kbd> to navigate between chapters</p>
                <p>Press <kbd>S</kbd> or <kbd>/</kbd> to search in the book</p>
                <p>Press <kbd>?</kbd> to show this help</p>
                <p>Press <kbd>Esc</kbd> to hide this help</p>
            </div>
        </div>
    </div>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                let theme = localStorage.getItem('mdbook-theme');
                let sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            const default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? default_dark_theme : default_light_theme;
            let theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            let sidebar = null;
            const sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
                sidebar_toggle.checked = false;
            }
            if (sidebar === 'visible') {
                sidebar_toggle.checked = true;
            } else {
                html.classList.remove('sidebar-visible');
            }
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="default_theme">Auto</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search (`/`)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="/ s" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title"></h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <div class="search-wrapper">
                            <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                            <div class="spinner-wrapper">
                                <i class="fa fa-spinner fa-spin"></i>
                            </div>
                        </div>
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="introduction"><a class="header" href="#introduction">Introduction</a></h1>
<p>Welcome to Stack Composer! This documentation is organized for users, developers, and operators.</p>
<ul>
<li><a href="getting-started/README.html">Getting Started</a></li>
<li><a href="architecture/README.html">Architecture</a></li>
<li><a href="components/README.html">Component Guides</a></li>
<li><a href="user-guides/README.html">User Guides</a></li>
<li><a href="operations/README.html">Operational Docs</a></li>
<li><a href="release-engineering/README.html">Release Engineering</a></li>
<li><a href="contributing/README.html">Contributing</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="getting-started"><a class="header" href="#getting-started">Getting Started</a></h1>
<p>Welcome to Stack Composer! This section will help you get up and running quickly, whether you’re a new user or setting up a fresh environment.</p>
<h2 id="section-structure"><a class="header" href="#section-structure">Section Structure</a></h2>
<pre><code class="language-mermaid">flowchart TD
  A[Getting Started] --&gt; B[Quick Start]
  A --&gt; C[Installation]
  A --&gt; D[System Requirements]
  A --&gt; E[FAQ]
</code></pre>
<h2 id="key-guides"><a class="header" href="#key-guides">Key Guides</a></h2>
<ul>
<li><a href="getting-started/./quickstart.html">Quick Start</a>: Step-by-step guide to your first Stack Composer experience.</li>
<li><a href="getting-started/../installation.html">Installation</a>: How to install Stack Composer on your system.</li>
<li><a href="getting-started/./system-requirements.html">System Requirements</a>: Minimum and recommended requirements.</li>
<li><a href="getting-started/../reference/faq.html">FAQ</a>: Frequently asked questions and troubleshooting tips.</li>
</ul>
<hr />
<p><strong>Next Steps:</strong></p>
<ul>
<li>Explore the <a href="getting-started/../configuration.html">User Guides</a> for more advanced usage.</li>
<li>Learn about <a href="getting-started/../plugin-sdk/README.html">Extensibility</a> to customize your experience.</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="quickstart"><a class="header" href="#quickstart">Quickstart</a></h1>
<p>Welcome to Stack Composer! This quickstart will help you get up and running quickly.</p>
<ol>
<li>Review <a href="getting-started/../developer-extensibility-docs/dev-setup.html">dev-setup.md</a> for environment setup.</li>
<li>Install all required tools as described in <a href="getting-started/../toolchain.html">toolchain.md</a>.</li>
<li>Follow the workflow in the <a href="getting-started/../../README.html">README</a> to start developing or contributing.</li>
</ol>
<blockquote>
<p><strong>Note:</strong> For details on using local Python/conda environments versus the devcontainer, see <a href="getting-started/../developer-extensibility-docs/dev-setup.html#python--conda-workflows#python--conda-workflows">dev-setup.md</a>.</p>
</blockquote>
<p>For troubleshooting, see the relevant sections in <a href="getting-started/../developer-extensibility-docs/dev-setup.html#troubleshooting#troubleshooting">dev-setup.md</a> and <a href="getting-started/../toolchain.html#troubleshooting">toolchain.md</a>.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="frequently-asked-questions-faq"><a class="header" href="#frequently-asked-questions-faq">Frequently Asked Questions (FAQ)</a></h1>
<p><strong>Q: What is Stack Composer?</strong>
A: Stack Composer is a modular, extensible platform for building, orchestrating, and operating AI-powered systems.</p>
<p><strong>Q: How do I get started?</strong>
A: See the <a href="reference/../getting-started/README.html">Getting Started Guide</a>.</p>
<p><strong>Q: How do I contribute?</strong>
A: See the <a href="reference/../contributing/README.html">Contributing Guide</a>.</p>
<p><strong>Q: Where can I find architecture diagrams?</strong>
A: See the <a href="reference/../architecture/architecture-overview.html">Architecture Overview</a>.</p>
<p><strong>Q: How is telemetry handled?</strong>
A: Telemetry is opt-in and anonymized. See <a href="reference/../operations/telemetry-privacy.html">Telemetry &amp; Privacy</a>.</p>
<p><strong>Q: How do I report a security issue?</strong>
A: See the <a href="reference/../operations/security-policy.html">Security Policy</a>.</p>
<p><em>Add more questions as needed.</em></p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="system-requirements"><a class="header" href="#system-requirements">System Requirements</a></h1>
<p>This document lists the supported platforms, dependencies, and hardware requirements for Stack Composer.</p>
<h2 id="supported-platforms"><a class="header" href="#supported-platforms">Supported Platforms</a></h2>
<ul>
<li><strong>OS:</strong> Ubuntu 22.04, macOS 13+, Windows 11 (WSL2 supported)</li>
<li><strong>Rust:</strong> ≥1.70 (nightly optional)</li>
<li><strong>Datastores:</strong> Qdrant ≥1.4, Meilisearch ≥1.5</li>
<li><strong>Planner Binaries:</strong> Fast Downward ≥23.05, OPTIC ≥latest commit</li>
</ul>
<h2 id="hardware-requirements"><a class="header" href="#hardware-requirements">Hardware Requirements</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Environment</th><th>RAM</th><th>CPU Cores</th><th>Disk Space</th></tr></thead><tbody>
<tr><td>Dev</td><td>8 GB</td><td>4</td><td>10 GB</td></tr>
<tr><td>Prod (single)</td><td>16 GB</td><td>8</td><td>100 GB</td></tr>
<tr><td>Cluster</td><td>Scale per node</td><td>Scale per node</td><td>See ops guide</td></tr>
</tbody></table>
</div>
<h2 id="notes"><a class="header" href="#notes">Notes</a></h2>
<ul>
<li>For best results, use a machine with SSD storage and a modern multi-core CPU.</li>
<li>Containerized deployments are supported and recommended for production.</li>
<li>See <a href="getting-started/../operations/ops-guide.html">ops-guide.md</a> for cluster scaling and advanced deployment scenarios.</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="user-guides"><a class="header" href="#user-guides">User Guides</a></h1>
<p>This section provides practical guides for configuring, using, and troubleshooting Stack Composer.</p>
<h2 id="section-structure-1"><a class="header" href="#section-structure-1">Section Structure</a></h2>
<pre><code class="language-mermaid">flowchart TD
  A[User Guides] --&gt; B[Configuration]
  A --&gt; C[Usage Guide]
  A --&gt; D[Troubleshooting]
</code></pre>
<h2 id="key-guides-1"><a class="header" href="#key-guides-1">Key Guides</a></h2>
<ul>
<li><a href="user-guides/../configuration.html">Configuration</a>: How to configure Stack Composer for your needs.</li>
<li><a href="user-guides/usage.html">Usage Guide</a>: In-depth usage instructions and tips.</li>
<li><a href="user-guides/troubleshooting.html">Troubleshooting</a>: Solutions to common issues.</li>
</ul>
<hr />
<p><strong>Next Steps:</strong></p>
<ul>
<li>Explore <a href="user-guides/../plugin-sdk/README.html">Extensibility</a> to customize Stack Composer.</li>
<li>Review <a href="user-guides/../operations/ops-guide.html">Operations &amp; Security</a> for deployment and security best practices.</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="configuration"><a class="header" href="#configuration">Configuration</a></h1>
<p>This guide describes how to configure Stack Composer, including plugin registration, runtime options, and security settings.</p>
<hr />
<h2 id="configuration-flow"><a class="header" href="#configuration-flow">Configuration Flow</a></h2>
<pre><code class="language-mermaid">flowchart TD
    A[Start] --&gt; B{Choose Plugin Type}
    B -- WASI --&gt; C[Copy .wasm &amp; .sig to plugins dir]
    B -- REST --&gt; D[Edit config file]
    C --&gt; E[Configure permissions]
    D --&gt; E
    E --&gt; F[Set runtime options]
    F --&gt; G[Enable telemetry (optional)]
    G --&gt; H[Save &amp; Restart Stack Composer]
</code></pre>
<hr />
<h2 id="1-plugin-registration"><a class="header" href="#1-plugin-registration">1. Plugin Registration</a></h2>
<h3 id="wasi-plugins"><a class="header" href="#wasi-plugins">WASI Plugins</a></h3>
<p>Add WASI plugins by copying <code>.wasm</code> and <code>.sig</code> files to:</p>
<pre><code class="language-text">~/.local/share/stack-composer/plugins/
</code></pre>
<p>Plugins are auto-discovered at startup. Only plugins with valid Ed25519 signatures (see <a href="user-guides/../extensibility/plugin-sdk.html">Plugin SDK</a>) are loaded.</p>
<h3 id="rest-plugins"><a class="header" href="#rest-plugins">REST Plugins</a></h3>
<p>Register REST plugins in your config file (TOML or YAML):</p>
<pre><code class="language-toml">[plugins.rest]
my_rest_plugin = { url = "http://localhost:3000/run" }
</code></pre>
<hr />
<h2 id="2-security--permissions"><a class="header" href="#2-security--permissions">2. Security &amp; Permissions</a></h2>
<ul>
<li><strong>Trusted Keys</strong>: List trusted Ed25519 public keys in <code>~/.config/stack-composer/trusted_keys.toml</code>.</li>
<li><strong>Plugin Permissions</strong>: Configure per-plugin filesystem/network access in the config file:</li>
</ul>
<pre><code class="language-toml">[plugins.wasi.hello_plugin]
allow_fs_write = false
allow_network = false
</code></pre>
<hr />
<h2 id="3-runtime-options"><a class="header" href="#3-runtime-options">3. Runtime Options</a></h2>
<ul>
<li><strong>Session Storage</strong>: Set session directory and retention policy.</li>
<li><strong>Telemetry</strong>: Enable/disable telemetry and set retention (default: 30 days).</li>
<li><strong>Model Backends</strong>: Configure LLM endpoints and fallback order.</li>
</ul>
<hr />
<h2 id="4-example-full-config"><a class="header" href="#4-example-full-config">4. Example Full Config</a></h2>
<pre><code class="language-toml">[plugins.wasi]
hello_plugin = { enabled = true }

[plugins.rest]
my_rest_plugin = { url = "http://localhost:3000/run" }

[security]
# ...
</code></pre>
<hr />
<p><strong>Next Steps:</strong></p>
<ul>
<li>See <a href="user-guides/usage.html">Usage Guide</a></li>
<li>Review <a href="user-guides/troubleshooting.html">Troubleshooting</a></li>
<li>Explore <a href="user-guides/../extensibility/component-details.html">Extensibility</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="usage-guide"><a class="header" href="#usage-guide">Usage Guide</a></h1>
<p><em>Last updated · 2025‑06‑20</em><br />
This guide walks you, click‑by‑click — and key‑stroke‑by‑keystroke — through the
full <strong>Stack Composer</strong> experience: from opening the application to exporting a
production‑ready repository. It covers every wizard screen, modal, shortcut and
status badge so you can move from <em>idea to initial commit</em> in minutes.</p>
<hr />
<h2 id="0--before-you-start"><a class="header" href="#0--before-you-start">0 · Before you start</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Requirement</th><th>Notes</th></tr></thead><tbody>
<tr><td>Project brief</td><td>PDF, DOCX, Markdown or plaintext.</td></tr>
<tr><td>Free disk</td><td>2 GB for binaries + 2 GB for the default 4‑bit model.</td></tr>
<tr><td>Ollama model</td><td>The wizard will download <code>phi‑3:4b</code> at first run if not present.</td></tr>
<tr><td>Accessibility</td><td>Every control is keyboard‑navigable; press <kbd>Alt+K</kbd> anywhere to display the shortcut legend.</td></tr>
</tbody></table>
</div>
<hr />
<h2 id="1--launch--home-screen"><a class="header" href="#1--launch--home-screen">1 · Launch &amp; Home Screen</a></h2>
<pre><code class="language-text">⌘ Space → “Stack Composer” ↵
</code></pre>
<ul>
<li><strong>Resume banner</strong> appears if an incomplete session JSON is found.</li>
<li><strong>New Project</strong> button opens the Hybrid Wizard (also <kbd>N</kbd>).</li>
</ul>
<hr />
<h2 id="2--hybrid-wizard-walkthrough"><a class="header" href="#2--hybrid-wizard-walkthrough">2 · Hybrid Wizard Walk‑through</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Step</th><th>Pane</th><th>What happens</th></tr></thead><tbody>
<tr><td><strong>Brief Upload</strong></td><td>Left: drag‑and‑drop zone • Right: real‑time text extractor preview</td><td>Parser detects type, shows page/word count, accessibility tags.</td></tr>
<tr><td><strong>Clarify Requirements</strong></td><td>Chat panel with LLM + structured form fields</td><td>Gaps auto‑detected; pressing <kbd>↵</kbd> submits, <kbd>Esc</kbd> skips.</td></tr>
<tr><td><strong>Stack Choices</strong></td><td>Tree view (React Arborist) of languages &amp; frameworks; Graph view toggle (React Flow + Dagre)</td><td>Choosing a node auto‑filters incompatible children; hover shows licence.</td></tr>
<tr><td><strong>Plan Preview</strong></td><td>Timeline table + optional Gantt chart if OPTIC used</td><td>Duration estimates, cost roll‑up and risk score pill.</td></tr>
<tr><td><strong>Plugins</strong></td><td>Signed plugin marketplace with search • details modal</td><td>Installing prompts signature check; capability grants listed.</td></tr>
<tr><td><strong>Review &amp; Generate</strong></td><td>Summary accordion + diff viewer for default scaffold</td><td>“Why?” tool‑tips next to each choice; click to show LLM rationale.</td></tr>
</tbody></table>
</div>
<h3 id="21-decision-timeline"><a class="header" href="#21-decision-timeline">2.1 Decision Timeline</a></h3>
<p>A collapsible sidebar records every choice (time‑stamp + diff hash). Use
<kbd>Ctrl + Z</kbd> / <kbd>Ctrl + Shift + Z</kbd> to undo/redo; hover over an
entry to jump back.</p>
<h3 id="22-conflictdetection-modal"><a class="header" href="#22-conflictdetection-modal">2.2 Conflict‑Detection Modal</a></h3>
<p>If you pick mutually exclusive options (e.g., <strong>GPL‑3 framework</strong> with
<strong>permissive licence only</strong>):</p>
<ul>
<li>Modal explains conflict in plain language.</li>
<li>“Are you sure?” button requires typing <strong>override</strong> to proceed.</li>
</ul>
<hr />
<h2 id="3--generation--output"><a class="header" href="#3--generation--output">3 · Generation &amp; Output</a></h2>
<ol>
<li>
<p>Spinner shows <strong>Hybrid RAG</strong> + <strong>Planner</strong> progress, each with p50 latency.</p>
</li>
<li>
<p>Upon success you can:</p>
<div class="table-wrapper"><table><thead><tr><th>Action</th><th>Shortcut</th><th>Result</th></tr></thead><tbody>
<tr><td><strong>Open Repo</strong></td><td><kbd>O</kbd></td><td>Opens scaffold in your default editor.</td></tr>
<tr><td><strong>Export Zip</strong></td><td><kbd>Z</kbd></td><td>Saves starter repo (<code>stack‑composer‑scaffold.zip</code>).</td></tr>
<tr><td><strong>Copy JSON</strong></td><td><kbd>C</kbd></td><td>Puts tech‑stack report on clipboard.</td></tr>
</tbody></table>
</div></li>
<li>
<p>A toast asks if you want to <strong>purge telemetry</strong> from the previous run.</p>
</li>
</ol>
<hr />
<h2 id="4--import--modernise-existing-repo"><a class="header" href="#4--import--modernise-existing-repo">4 · Import &amp; Modernise Existing Repo</a></h2>
<ul>
<li>Home Screen → <strong>Import Repository</strong> → choose folder.</li>
<li>Static analyser runs ESLint, Clippy, dep‑scan; surfaces debt dashboard.</li>
<li>“Auto‑Refactor” checkbox rewrites outdated patterns in‑place; a Git commit is
created so you can review.</li>
</ul>
<hr />
<h2 id="5--keyboard-shortcuts-cheatsheet"><a class="header" href="#5--keyboard-shortcuts-cheatsheet">5 · Keyboard Shortcuts Cheat‑Sheet</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Global</th><th>Action</th></tr></thead><tbody>
<tr><td><kbd>Alt + K</kbd></td><td>Show keyboard help</td></tr>
<tr><td><kbd>Ctrl + P</kbd></td><td>Command palette</td></tr>
<tr><td><kbd>Ctrl + S</kbd></td><td>Save session</td></tr>
<tr><td><kbd>Ctrl + Shift + L</kbd></td><td>Toggle light/dark theme</td></tr>
</tbody></table>
</div><div class="table-wrapper"><table><thead><tr><th>Wizard</th><th>Action</th></tr></thead><tbody>
<tr><td><kbd>Tab</kbd>/<kbd>Shift + Tab</kbd></td><td>Next/prev input</td></tr>
<tr><td><kbd>Esc</kbd></td><td>Dismiss modal</td></tr>
<tr><td><kbd>⌘ + ←</kbd>/<kbd>⌘ + →</kbd></td><td>Prev/next wizard step</td></tr>
</tbody></table>
</div>
<hr />
<h2 id="6--plugin-management"><a class="header" href="#6--plugin-management">6 · Plugin Management</a></h2>
<ul>
<li><strong>Settings ▸ Plugins</strong> lists installed bundles; red shield = signature fail.</li>
<li>Click <strong>Add Plugin</strong> → file picker; <code>.wasm</code> + <code>.sig</code> files copied to plugin dir.</li>
<li>Toggle capabilities (retrieval, llm, network) per plugin.</li>
</ul>
<hr />
<h2 id="7--model-detection--selection"><a class="header" href="#7--model-detection--selection">7 · Model Detection &amp; Selection</a></h2>
<p>On <strong>Settings ▸ LLMs</strong> the app probes, in order:</p>
<ol>
<li>vLLM (<code>localhost:8000</code>)</li>
<li>LM Studio (<code>localhost:1234</code>)</li>
<li>HF TGI (<code>localhost:8080</code>)</li>
<li>Ollama (<code>localhost:11434</code>)</li>
</ol>
<p>Detected runtimes appear as radio buttons; select and test with the “Ping”
button. If none found, an <strong>Install Ollama</strong> prompt appears (shell installer).</p>
<hr />
<h2 id="8--session--telemetry"><a class="header" href="#8--session--telemetry">8 · Session &amp; Telemetry</a></h2>
<ul>
<li>Sessions auto‑save every 60 s to<br />
<code>~/Library/Application Support/Stack Composer/sessions/*.json</code> (or
<code>$XDG_DATA_HOME</code> on Linux).</li>
<li>Telemetry JSON chunks stored for 30 days; purge with
<strong>Settings ▸ Privacy ▸ Delete Telemetry</strong>.</li>
</ul>
<hr />
<h2 id="9--troubleshooting-highlights"><a class="header" href="#9--troubleshooting-highlights">9 · Troubleshooting Highlights</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Symptom</th><th>Quick Fix</th></tr></thead><tbody>
<tr><td>“Ollama server not reachable”</td><td>Run <code>ollama serve</code> or change port in Settings.</td></tr>
<tr><td>Planner timeout</td><td>Increase limit (<code>Settings ▸ Planner ▸ Timeout</code>).</td></tr>
<tr><td>Plugin quarantine</td><td>Check <code>.sig</code> and trusted keys list.</td></tr>
<tr><td>High memory</td><td>Switch to 4‑bit model or disable RL‑Critic.</td></tr>
</tbody></table>
</div>
<p>More in <a href="user-guides/troubleshooting.html">Troubleshooting</a>.</p>
<hr />
<h2 id="10--next-steps"><a class="header" href="#10--next-steps">10 · Next Steps</a></h2>
<ul>
<li>Dive into <a href="user-guides/configuration.html">Configuration</a> to tweak embeddings, chunk size and planner aliases.</li>
<li>Write your first extension with the <a href="user-guides/../plugin-sdk/README.html">Plugin SDK</a>.</li>
<li>Join the conversation on GitHub Discussions to request features or share templates.</li>
</ul>
<p>Happy composing! 🎉</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="troubleshooting"><a class="header" href="#troubleshooting">Troubleshooting</a></h1>
<p>This guide helps you resolve common issues with Stack Composer.</p>
<hr />
<h2 id="common-issues"><a class="header" href="#common-issues">Common Issues</a></h2>
<h3 id="ollama-server-not-reachable"><a class="header" href="#ollama-server-not-reachable">Ollama server not reachable</a></h3>
<ul>
<li>Start <code>ollama serve</code> and ensure port 11434 is free.</li>
</ul>
<h3 id="high-memory-usage"><a class="header" href="#high-memory-usage">High memory usage</a></h3>
<ul>
<li>Use the 4-bit model or close other apps.</li>
</ul>
<h3 id="planner-timeout"><a class="header" href="#planner-timeout">Planner timeout</a></h3>
<ul>
<li>Add <code>--planner-timeout 60</code> or simplify your brief.</li>
</ul>
<hr />
<h2 id="more-help"><a class="header" href="#more-help">More Help</a></h2>
<ul>
<li>See <a href="user-guides/../reference/faq.html">FAQ</a></li>
<li>Check <a href="user-guides/../developer-extensibility-docs/dev-setup.html#troubleshooting">dev-setup.md</a></li>
<li>Open a GitHub Issue or Discussion for unresolved problems.</li>
</ul>
<hr />
<p><strong>Next Steps:</strong></p>
<ul>
<li>Review <a href="user-guides/usage.html">Usage Guide</a></li>
<li>Explore <a href="user-guides/configuration.html">Configuration</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="architecture--roadmap"><a class="header" href="#architecture--roadmap">Architecture &amp; Roadmap</a></h1>
<p>Understand the design, platform architecture, and future direction of Stack Composer.</p>
<h2 id="section-structure-2"><a class="header" href="#section-structure-2">Section Structure</a></h2>
<pre><code class="language-mermaid">flowchart TD
  A[Architecture &amp; Roadmap] --&gt; B[Architecture Overview]
  A --&gt; C[AI Platform Overview]
  A --&gt; D[Roadmap]
  A --&gt; E[ADRs]
</code></pre>
<h2 id="key-guides-2"><a class="header" href="#key-guides-2">Key Guides</a></h2>
<ul>
<li><a href="architecture/../architecture/architecture-overview.html">Architecture Overview</a>: High-level system design.</li>
<li><a href="architecture/../ai-platform-overview/ai-platform-overview.html">AI Platform Overview</a>: AI subsystem details.</li>
<li><a href="architecture/../release-engineering/roadmap.html">Roadmap</a>: Planned features and milestones.</li>
<li><a href="architecture/../adr/0000-template.html">ADRs</a>: Architectural decision records.</li>
<li><a href="architecture/context.html">Context</a></li>
<li><a href="architecture/containers.html">Containers</a></li>
<li><a href="architecture/components.html">Components</a></li>
<li><a href="architecture/data-flow.html">Data Flow</a></li>
<li><a href="architecture/extensibility.html">Extensibility</a></li>
</ul>
<hr />
<p><strong>Next Steps:</strong></p>
<ul>
<li>Review <a href="architecture/../operations/ops-guide.html">Operations &amp; Security</a> for deployment and security.</li>
<li>Explore <a href="architecture/../plugin-sdk/README.html">Extensibility</a> for customization.</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="architecture-overview"><a class="header" href="#architecture-overview">Architecture Overview</a></h1>
<blockquote>
<p><strong>Developer Environment:</strong> For details on the required toolchain, reproducible setup, and all supporting tools (Rust, Node, Docker, Nix, Qdrant, Meilisearch, etc.), see <a href="architecture/toolchain.html">Toolchain &amp; DX Pipeline</a> and <a href="architecture/developer-extensibility-docs/dev-setup.html">Developer Setup</a>.</p>
</blockquote>
<p>This document explains <strong>how Stack Composer works</strong> and how its components communicate at run-time.</p>
<hr />
<blockquote>
<p><strong>Modular Docs:</strong> This overview is split into focused modules:</p>
<ul>
<li><a href="architecture/context.html">Context</a></li>
<li><a href="architecture/containers.html">Containers</a></li>
<li><a href="architecture/components.html">Components</a></li>
<li><a href="architecture/data-flow.html">Data Flow</a></li>
<li><a href="architecture/extensibility.html">Extensibility</a></li>
</ul>
</blockquote>
<hr />
<h2 id="c4-context-diagram"><a class="header" href="#c4-context-diagram">C4 Context Diagram</a></h2>
<pre><code class="language-mermaid">flowchart TD
    User((User))
    Admin((Admin))
    StackComposer["Stack Composer Desktop App"]
    Qdrant[(Qdrant Vector DB)]
    Meili[(Meilisearch)]
    Planner[(Fast Downward / OPTIC)]
    Plugin[[WASI Plugins]]
    Web["Web (Docs, Updates)"]

    User -- "Brief, Actions" --&gt; StackComposer
    Admin -- "Config, Monitoring" --&gt; StackComposer
    StackComposer -- "Hybrid Search" --&gt; Qdrant
    StackComposer -- "Hybrid Search" --&gt; Meili
    StackComposer -- "Plan Request" --&gt; Planner
    StackComposer -- "Plugin Calls" --&gt; Plugin
    StackComposer -- "Check for Updates" --&gt; Web
</code></pre>
<p><strong>Responsibilities:</strong></p>
<ul>
<li>
<p>Stack Composer ingests briefs, interacts with users/admins, and orchestrates retrieval, planning, and plugin execution.</p>
</li>
<li>
<p>External dependencies: Qdrant, Meilisearch, planners, plugins, and web resources.</p>
</li>
<li>
<p>Data flows: User input → Stack Composer → retrieval/planning/plugins → output (report, scaffold, telemetry).</p>
</li>
</ul>
<hr />
<h2 id="c4-container-diagram"><a class="header" href="#c4-container-diagram">C4 Container Diagram</a></h2>
<pre><code class="language-mermaid">flowchart TD
    subgraph DesktopApp
        UI["UI (Tauri + React)"]
        ORCH["Orchestrator (Rust)"]
        RETR["Retrieval Layer"]
        PLAN["Planner Adapter"]
        PLUG["Plugin Host"]
        TELE["Telemetry"]
        REPORT["Report Agent"]
        GAP["Gap Agent"]
    end
    Qdrant[(Qdrant)]
    Meili[(Meilisearch)]
    Planner[(Fast Downward / OPTIC)]
    Plugin[[WASI Plugins]]

    UI --IPC/gRPC--&gt; ORCH
    ORCH --async--&gt; RETR
    ORCH --async--&gt; PLAN
    ORCH --async--&gt; PLUG
    ORCH --async--&gt; TELE
    ORCH --async--&gt; REPORT
    ORCH --async--&gt; GAP
    RETR --REST--&gt; Qdrant
    RETR --REST--&gt; Meili
    PLAN --CLI--&gt; Planner
    PLUG --WASI--&gt; Plugin
</code></pre>
<p><strong>Responsibilities:</strong></p>
<ul>
<li>
<p>UI: User interaction, brief upload, results display.</p>
</li>
<li>
<p>Orchestrator: Coordinates all agents, plugins, and runtime tasks.</p>
</li>
<li>
<p>Retrieval Layer: Handles hybrid search (Qdrant + Meilisearch).</p>
</li>
<li>
<p>Planner Adapter: Invokes external planners via CLI.</p>
</li>
<li>
<p>Plugin Host: Runs WASI plugins securely.</p>
</li>
<li>
<p>Telemetry: Collects and exports metrics/events.</p>
</li>
<li>
<p>Report Agent: Generates reports and scaffolds.</p>
</li>
<li>
<p>Gap Agent: Identifies missing requirements and triggers clarifying questions.</p>
</li>
</ul>
<p><strong>Dependencies:</strong></p>
<ul>
<li>Qdrant, Meilisearch, planners, plugins.</li>
</ul>
<p><strong>Data Flow:</strong></p>
<ul>
<li>UI/CLI → Orchestrator → agents/components → external services → results back to UI/CLI.</li>
</ul>
<hr />
<h2 id="high-level-block-diagram"><a class="header" href="#high-level-block-diagram">High-Level Block Diagram</a></h2>
<pre><code class="language-mermaid">flowchart TD
    classDef comp fill:#f9f9f9,stroke:#333,stroke-width:1px,rx:6,ry:6
    subgraph Desktop
        UI[Tauri ± React] -.IPC.-&gt; ORCH(Rust Orchestrator)
        ORCH --&gt;|REST| OLL(Ollama LLM runtime)
        ORCH --&gt; RETR[Qdrant (embed) + Meilisearch 1.6]
        ORCH --&gt;|gRPC| PLAN(Fast Downward / OPTIC)
        ORCH --&gt; PLUG[[Wasmtime WASI plugins]]
    end
    CRAWL((Weekly Ontology Crawler)) --&gt; RETR
    CRAWL --&gt; RETR
</code></pre>
<ul>
<li>
<p>Tauri binaries are smaller and use less RAM than Electron.</p>
</li>
<li>
<p>Ollama exposes a simple localhost REST API (port 11434) for streaming tokens.</p>
</li>
<li>
<p>Qdrant 0.15 embedded-mode removes the need for an external vector DB process.</p>
</li>
<li>
<p>Meilisearch 1.6 introduces hybrid (dense + sparse) search in a single index.</p>
</li>
<li>
<p>Fast Downward is the de-facto PDDL planner; its GPL-2 exception allows subprocess use in closed binaries.</p>
</li>
<li>
<p>Wasmtime 1.x is production-ready for secure WASI sandboxing.</p>
</li>
<li>
<p>Unsloth 4-bit quantisation halves VRAM for phi-3 without meaningful accuracy loss.</p>
</li>
<li>
<p>GraphRAG (future plug-in) lets the LLM walk a property-graph for richer, lower-hallucination answers.</p>
</li>
</ul>
<hr />
<h2 id="subsystem-table"><a class="header" href="#subsystem-table">Subsystem Table</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Subsystem</th><th>Tech</th><th>Highlights</th></tr></thead><tbody>
<tr><td>LLM runtime</td><td>Ollama + phi-3 GGUF-4bit</td><td>Local, hot-swappable; REST streaming.</td></tr>
<tr><td>Retrieval</td><td>Qdrant (dense) + Meilisearch (BM25)</td><td>Hybrid fusion improves precision &amp; recall.</td></tr>
<tr><td>Chunking</td><td>SentencePiece, 256-token windows</td><td>Proven sweet-spot for context reuse.</td></tr>
<tr><td>Planning</td><td>Fast Downward / OPTIC</td><td>Classical + temporal plan generation.</td></tr>
<tr><td>Telemetry</td><td>OpenTelemetry file exporter (JSON)</td><td>Opt-in, manual upload only.</td></tr>
<tr><td>Docs-as-Code</td><td>mdBook + ADR repo</td><td>Write docs with same tools as code.</td></tr>
<tr><td>Governance</td><td>Joel Parker Henderson ADR templates</td><td>Decisions captured alongside code.</td></tr>
</tbody></table>
</div>
<hr />
<h2 id="data-flow-compose-stack-request"><a class="header" href="#data-flow-compose-stack-request">Data Flow (“Compose Stack” request)</a></h2>
<ol>
<li>Brief ingestion – UI or CLI sends the document to the Rust IngestionAgent, which chunks and embeds it (SentencePiece → GGUF).</li>
<li>Gap analysis – GapAgent queries the knowledge graph; unanswered slots trigger clarifying questions in the chat UI.</li>
<li>Retrieval – StackAgent issues hybrid search queries:
• dense cosine on Qdrant,
• sparse BM25 on Meilisearch,
then merges the scored sets.</li>
<li>Planning (optional) – If --planner is on, domain &amp; problem PDDL files are generated and solved by Fast Downward; the plan comes back as a sequence of stack-construction actions.</li>
<li>Critic loop – (future) RL critic re-scores alternative stacks to optimise for build time and licence risk.</li>
<li>Report generation – ReportAgent merges citations, plan steps, and UML diagrams into HTML/Markdown, then offers a JSON export and repo scaffold.</li>
</ol>
<hr />
<h2 id="runtime-layers--technologies"><a class="header" href="#runtime-layers--technologies">Runtime Layers &amp; Technologies</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Layer</th><th>Component</th><th>Rationale</th></tr></thead><tbody>
<tr><td>UI Shell</td><td>Tauri + React</td><td>2–3 MB installers and ~58% less RAM than Electron</td></tr>
<tr><td>Orchestrator</td><td>Rust / Tokio</td><td>Memory-safe, zero-cost FFI to Wasmtime</td></tr>
<tr><td>LLM Runtime</td><td>Ollama + GGUF 4-bit</td><td>Local, private LLMs; REST streaming</td></tr>
<tr><td>Retrieval</td><td>Qdrant (embedded)</td><td>No external DB to install</td></tr>
<tr><td>Hybrid Search</td><td>Meilisearch 1.6</td><td>Combines dense &amp; sparse ranking</td></tr>
<tr><td>Planner</td><td>Fast Downward</td><td>Classical PDDL with GPL-2 exception</td></tr>
<tr><td>Plugins</td><td>Wasmtime (WASI)</td><td>Syscall-sandboxed execution</td></tr>
<tr><td>Docs</td><td>mdBook</td><td>Rust-native docs-as-code</td></tr>
</tbody></table>
</div>
<hr />
<h2 id="extensibility-points"><a class="header" href="#extensibility-points">Extensibility Points</a></h2>
<ul>
<li>
<p>WASI capability tokens – restrict plugins to declarative host functions.</p>
</li>
<li>
<p>Model abstraction trait – swap Ollama REST calls with vLLM, LM-Studio, or Hugging Face TGI without touching agent logic.</p>
</li>
<li>
<p>GraphRAG plug-in – future Rust crate to replace the current retrieval layer with a property-graph walk.</p>
</li>
</ul>
<hr />
<h2 id="next-reading"><a class="header" href="#next-reading">Next Reading</a></h2>
<ul>
<li>
<p><a href="architecture/component-details/README.html">Component-Details Index</a></p>
</li>
<li>
<p><a href="architecture/planner-integration.html">Planner Integration</a></p>
</li>
<li>
<p><a href="architecture/plugin-sdk/README.html">Plugin SDK</a></p>
</li>
</ul>
<hr />
<div style="break-before: page; page-break-before: always;"></div><h1 id="context"><a class="header" href="#context">Context</a></h1>
<p>This module explains the context and external actors for Stack Composer, as referenced in the architecture overview.</p>
<ul>
<li><strong>Users:</strong> End-users and admins interact with the desktop app to ingest briefs, configure settings, and review results.</li>
<li><strong>External Services:</strong> Qdrant, Meilisearch, planners, plugins, and web resources provide retrieval, planning, and extensibility.</li>
</ul>
<p>See the <a href="architecture/architecture-overview.html#c4-context-diagram">C4 Context Diagram</a> for a visual summary.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="containers"><a class="header" href="#containers">Containers</a></h1>
<p>This module details the main containers (processes/services) in Stack Composer, as referenced in the architecture overview.</p>
<ul>
<li><strong>Desktop App:</strong> Tauri + React UI, Rust orchestrator, and all agents/components.</li>
<li><strong>Qdrant &amp; Meilisearch:</strong> Embedded vector and search DBs for hybrid retrieval.</li>
<li><strong>Planner:</strong> Fast Downward/OPTIC for PDDL planning.</li>
<li><strong>Plugins:</strong> Wasmtime-hosted WASI plugins for extensibility.</li>
</ul>
<p>See the <a href="architecture/architecture-overview.html#c4-container-diagram">C4 Container Diagram</a> for a visual summary.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="components"><a class="header" href="#components">Components</a></h1>
<p>This module describes the key components/agents in Stack Composer, as referenced in the architecture overview.</p>
<ul>
<li><strong>UI:</strong> Tauri + React frontend for user interaction.</li>
<li><strong>Orchestrator:</strong> Rust core coordinating all agents and plugins.</li>
<li><strong>Retrieval Layer:</strong> Hybrid search using Qdrant and Meilisearch.</li>
<li><strong>Planner Adapter:</strong> CLI interface to Fast Downward/OPTIC.</li>
<li><strong>Plugin Host:</strong> Secure WASI plugin execution.</li>
<li><strong>Telemetry:</strong> Metrics and event collection/export.</li>
<li><strong>Report Agent:</strong> Generates reports and scaffolds.</li>
<li><strong>Gap Agent:</strong> Identifies missing requirements and triggers clarifying questions.</li>
</ul>
<p>See the <a href="architecture/architecture-overview.html#c4-container-diagram">C4 Container Diagram</a> and <a href="architecture/component-details/README.html">Component-Details Index</a> for more.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="data-flow"><a class="header" href="#data-flow">Data Flow</a></h1>
<p>This module details the data flow for a typical "Compose Stack" request in Stack Composer.</p>
<ol>
<li><strong>Brief ingestion:</strong> UI/CLI sends the document to the IngestionAgent for chunking and embedding.</li>
<li><strong>Gap analysis:</strong> GapAgent queries the knowledge graph and triggers clarifying questions.</li>
<li><strong>Retrieval:</strong> StackAgent issues hybrid search queries to Qdrant and Meilisearch, merging results.</li>
<li><strong>Planning (optional):</strong> Planner generates and solves PDDL files for stack construction.</li>
<li><strong>Critic loop (future):</strong> RL critic re-scores alternative stacks.</li>
<li><strong>Report generation:</strong> ReportAgent merges citations, plan steps, and diagrams into output files.</li>
</ol>
<p>See <a href="architecture/architecture-overview.html#data-flow-compose-stack-request">architecture-overview.md</a> for more.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="extensibility"><a class="header" href="#extensibility">Extensibility</a></h1>
<p>This module summarizes extensibility points in Stack Composer.</p>
<ul>
<li><strong>WASI capability tokens:</strong> Restrict plugins to declarative host functions.</li>
<li><strong>Model abstraction trait:</strong> Swap LLM backends (Ollama, vLLM, LM-Studio, etc.) without changing agent logic.</li>
<li><strong>GraphRAG plug-in:</strong> (Planned) Property-graph retrieval for richer answers.</li>
</ul>
<p>See <a href="architecture/architecture-overview.html#extensibility-points">architecture-overview.md</a> and <a href="architecture/../plugin-sdk/README.html">Plugin SDK</a> for more.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="roadmap"><a class="header" href="#roadmap">Roadmap</a></h1>
<p>This architecture roadmap mirrors <code>ROADMAP.md</code> with a focus on system
capabilities and long-term bets. Use it when aligning component design docs or
preparing RFCs.</p>
<h2 id="frontier-milestones"><a class="header" href="#frontier-milestones">Frontier Milestones</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Horizon</th><th>Focus</th><th>Target Timeline</th></tr></thead><tbody>
<tr><td>Now</td><td>Toolchain pinning, agent baselines, wizard v1, eval harness</td><td>Sprints S-01–S-02</td></tr>
<tr><td>Next</td><td>Planner repair, plugin SDK v1 GA, stack explorer, resilience</td><td>Sprints S-03–S-06</td></tr>
<tr><td>Later</td><td>Federated orchestration, GraphRAG, marketplace GA</td><td>Post S-06</td></tr>
</tbody></table>
</div>
<h2 id="migration-tracker"><a class="header" href="#migration-tracker">Migration Tracker</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Area</th><th>Task</th><th>Status</th></tr></thead><tbody>
<tr><td>Tooling</td><td>Commit <code>rust-toolchain.toml</code>, pin pnpm/Tauri versions</td><td>TODO</td></tr>
<tr><td>Docs</td><td>Migration playbook, navigation cleanup, ADR links in PRs</td><td>In Progress</td></tr>
<tr><td>Agents</td><td>Baseline ingestion/retrieval/critic/telemetry pipelines</td><td>TODO</td></tr>
<tr><td>Evaluation</td><td>Harness (nDCG/P/R/faithfulness) + dashboard</td><td>TODO</td></tr>
<tr><td>Wizard</td><td>shadcn/Radix tokens, citations, reduced-motion support</td><td>In Progress</td></tr>
<tr><td>Telemetry</td><td>OpenTelemetry spans + Prometheus exporter</td><td>TODO</td></tr>
</tbody></table>
</div>
<p>Update this table as migration tasks land. It should reflect the current state
of the main branch.</p>
<h2 id="strategic-roadmap-20252026"><a class="header" href="#strategic-roadmap-20252026">Strategic Roadmap (2025–2026)</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Area</th><th>Short-Term (0–3 mo)</th><th>Mid-Term (3–6 mo)</th><th>Long-Term (6–12 mo+)</th></tr></thead><tbody>
<tr><td>Plugin Ecosystem</td><td>SDK v1, signing CLI, marketplace staging</td><td>Marketplace GA, revenue/share models</td><td>Community moderation, automated trust scores</td></tr>
<tr><td>Retrieval</td><td>Eval harness, ONNX reranker, ontology freshness</td><td>GraphRAG enrichment, latency budgets</td><td>Hierarchical/Graph retrievers, active learning loops</td></tr>
<tr><td>Planning</td><td>Partial repair, timeline UI, constraint diffing</td><td>Cooperative planning (planner + critic)</td><td>Autonomous remediation, DSL planner options</td></tr>
<tr><td>LLM Runtime</td><td>Typed IPC, model adapters (Ollama/vLLM)</td><td>Adaptive model selection, evaluation plateaus</td><td>Model marketplace, on-demand fine-tuning integrations</td></tr>
<tr><td>Telemetry</td><td>OpenTelemetry + Prometheus baseline</td><td>Optional hosted telemetry backend</td><td>Predictive alerts, anomaly detection, AI ops copilot</td></tr>
<tr><td>Experience</td><td>Wizard v1, stack explorer beta, copilot interactions</td><td>Collaboration (comments, bookmarks), scenario diff</td><td>Real-time scaffold preview, modernization workflows</td></tr>
<tr><td>Release</td><td>Deterministic builds, signed artefacts, SBOM/provenance</td><td>Resilience suite, selective tests</td><td>Automated release train, downstream integrations</td></tr>
<tr><td>Distributed</td><td>Devcontainer/Nix parity, remote retrieval adapters</td><td>Sharded orchestrators, remote planner execution</td><td>Federated orchestrator mesh, multi-tenant control plane</td></tr>
</tbody></table>
</div>
<h2 id="ai-guided-authoring--scaffolding"><a class="header" href="#ai-guided-authoring--scaffolding">AI-Guided Authoring &amp; Scaffolding</a></h2>
<p>Stack Composer is evolving into a fully AI-guided, end-to-end project authoring
and scaffolding platform. See
<a href="architecture/../architecture-and-component-guides/ai-wizard-roadmap.html">ai-wizard-roadmap.md</a>
for the detailed product vision and phased implementation plan.</p>
<ul>
<li>Hybrid conversational wizard for discovery and planning</li>
<li>Interactive stack exploration and “what-if” analysis</li>
<li>Real-time directory tree and scaffold preview (graph + timeline)</li>
<li>Copilot with rationale tooltips and decision history</li>
<li>Context-aware recommendations, risk surfacing, and best-practice updates</li>
<li>One-click project generation, export, and cloud deployment hooks</li>
<li>Template packs, modernization flows, and project history</li>
</ul>
<hr />
<p><strong>Next Steps:</strong></p>
<ul>
<li>Review <a href="architecture/migration.html">Migration Playbook</a></li>
<li>Align the <a href="architecture/observability.html">Observability stack</a> with upcoming telemetry work</li>
<li>Update <a href="architecture/../extensibility/component-details.html">Component Details</a></li>
<li>Join the <a href="architecture/../contributing/README.html">Community</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="observability-stack"><a class="header" href="#observability-stack">Observability Stack</a></h1>
<p>This page tracks recommended tooling for metrics, traces, and evaluation. All
options are open source or free for commercial redistribution.</p>
<h2 id="core-signals"><a class="header" href="#core-signals">Core Signals</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Signal</th><th>Tooling</th><th>Notes</th></tr></thead><tbody>
<tr><td>Traces</td><td>OpenTelemetry SDK + SigNoz (Apache 2.0)</td><td>Collect spans from orchestrator/agents; SigNoz ships in Docker compose.</td></tr>
<tr><td>Metrics</td><td>Prometheus (Apache 2.0)</td><td>Export orchestrator/agent metrics; dashboards built in Grafana (AGPL 3).</td></tr>
<tr><td>Logs</td><td>Vector/Fluent Bit (Apache 2.0)</td><td>Optional centralised log shipping.</td></tr>
<tr><td>UX</td><td>Playwright traces + Visual Regression</td><td>Already wired through CI (S-01 deliverable).</td></tr>
</tbody></table>
</div>
<h2 id="recommended-setup"><a class="header" href="#recommended-setup">Recommended Setup</a></h2>
<ol>
<li>Launch SigNoz locally (Docker compose) or point to an existing deployment.</li>
<li>Configure the telemetry agent to export OpenTelemetry traces/metrics to
SigNoz/Prometheus; document endpoints in <code>docs/src/components/telemetry.md</code>.</li>
<li>Add Grafana dashboards for retrieval nDCG, planner solve latency, and wizard
activation metrics. Link dashboards in ADRs/OKRs.</li>
<li>Ensure CI uploads traces for failing tests (<code>ROADMAP.md</code> requirement).</li>
</ol>
<h2 id="evaluation-harness"><a class="header" href="#evaluation-harness">Evaluation Harness</a></h2>
<ul>
<li>Use <strong>RagaS</strong> (Apache 2.0) or <strong>DeepEval</strong> (Apache 2.0) to power the retrieval
evaluation harness. Store results as JSONL and publish summary dashboards.</li>
<li>The harness should run nightly and on-demand (<code>just smoke</code> remains the fast
check; a future <code>just eval</code> recipe will wrap the longer run).</li>
</ul>
<p>Update this document as the observability stack evolves (e.g., adding SigNoz
compose files or hosted backends).</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="stack-composer-ai-platform-overview"><a class="header" href="#stack-composer-ai-platform-overview">Stack Composer AI Platform Overview</a></h1>
<p>This document serves as the high-level index and vision for Stack Composer’s next-generation, AI-guided orchestration platform. It links to all major architectural, component, and roadmap documents, and summarizes the core philosophy, accessibility, and internationalization goals.</p>
<hr />
<h2 id="vision--roadmap"><a class="header" href="#vision--roadmap">Vision &amp; Roadmap</a></h2>
<ul>
<li>See <a href="architecture/ai-wizard-roadmap.html">AI Wizard Roadmap</a> for the phased plan and feature set.</li>
<li>See <a href="architecture/architecture-questions.html">Architecture Questions</a> for open questions, technical details, and deployment plan.</li>
</ul>
<h2 id="component-index"><a class="header" href="#component-index">Component Index</a></h2>
<ul>
<li><a href="architecture/../component-details/README.html">Component Details Index</a>: Responsibilities, APIs, and extension hooks for all major modules.</li>
<li><a href="architecture/../component-details/planner-adapter.html">Planner Adapter</a>: Planning, Fast Downward integration, and roadmap.</li>
<li><a href="architecture/../component-details/llm-runtime.html">LLM Runtime</a>: LLM abstraction, adapters, and model management.</li>
<li><a href="architecture/../component-details/plugin-host.html">Plugin Host</a>: WASI plugins, registry, and security.</li>
<li><a href="architecture/../component-details/retrieval-layer.html">Retrieval Layer</a>: Hybrid search, GraphRAG, and modularity.</li>
<li><a href="architecture/../component-details/telemetry.html">Telemetry</a>: Observability, feedback, and dashboards.</li>
<li><a href="architecture/../component-details/report-agent.html">Report Agent</a>: Output formats, export, and workflow integration.</li>
<li><a href="architecture/../component-details/stack-agent.html">Stack Agent</a>: Stack synthesis, REST API, and extensibility.</li>
<li><a href="architecture/../component-details/gap-agent.html">Gap Agent</a>: Requirements analysis and clarifying questions.</li>
<li><a href="architecture/../component-details/ingestion-agent.html">Ingestion Agent</a>: Brief parsing, chunking, and embedding.</li>
<li><a href="architecture/../component-details/orchestrator.html">Orchestrator</a>: Agent coordination and extensibility.</li>
<li><a href="architecture/../component-details/ontology-crawler.html">Ontology Crawler</a>: Knowledge graph and ontology updates.</li>
</ul>
<h2 id="accessibility--internationalization"><a class="header" href="#accessibility--internationalization">Accessibility &amp; Internationalization</a></h2>
<ul>
<li><a href="architecture/../accessibility.html">Accessibility Statement</a> (planned): Commitment to keyboard, ARIA, and screen reader support.</li>
<li><a href="architecture/../internationalization.html">Internationalization</a> (planned): Strategy for multi-language and locale support.</li>
</ul>
<h2 id="navigation"><a class="header" href="#navigation">Navigation</a></h2>
<ul>
<li><a href="architecture/roadmap.html">Main Roadmap</a></li>
<li><a href="architecture/architecture-overview.html">Architecture Overview</a></li>
<li><a href="architecture/ai-wizard-roadmap.html">AI Wizard Roadmap</a></li>
<li><a href="architecture/architecture-questions.html">Architecture Questions</a></li>
</ul>
<hr />
<p><em>Use this document as your starting point for all Stack Composer architecture, planning, and implementation work.</em></p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="deprecated-use-docssrcarchitectureadr0000-templatemd"><a class="header" href="#deprecated-use-docssrcarchitectureadr0000-templatemd">DEPRECATED: Use docs/src/architecture/adr/0000-template.md</a></h1>
<p>This file is a legacy placeholder. The canonical ADR template is now located at:</p>
<ul>
<li>docs/src/architecture/adr/0000-template.md</li>
</ul>
<p>Please update references and remove this file after validation.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="component-details-index"><a class="header" href="#component-details-index">Component Details Index</a></h1>
<p><em>All major modules in <strong>Stack Composer</strong> are documented here. When you touch a
component, update its corresponding Markdown so the docs never trail the code.</em></p>
<p>{% include "../_includes/toolchain.md" %}</p>
<blockquote>
<p>For detailed technical mapping, diagrams, and crate relationships, see <a href="components/../component-details/README.html">../component-details/README.md</a>.</p>
</blockquote>
<div class="table-wrapper"><table><thead><tr><th>#</th><th>Component</th><th>File</th><th>Status</th></tr></thead><tbody>
<tr><td>1</td><td><strong>Rust Orchestrator</strong></td><td><a href="components/orchestrator.html"><code>orchestrator.md</code></a></td><td><strong>In Progress</strong></td></tr>
<tr><td>2</td><td><strong>LLM Runtime Abstraction</strong></td><td><a href="components/llm-runtime.html"><code>llm-runtime.md</code></a></td><td>Draft</td></tr>
<tr><td>3</td><td><strong>Retrieval Layer (Qdrant + Meilisearch)</strong></td><td><a href="components/retrieval-layer.html"><code>retrieval-layer.md</code></a></td><td>Draft</td></tr>
<tr><td>4</td><td><strong>Ingestion Agent</strong></td><td><a href="components/ingestion-agent.html"><code>ingestion-agent.md</code></a></td><td>Draft</td></tr>
<tr><td>5</td><td><strong>Gap‑Analysis Agent</strong></td><td><a href="components/gap-agent.html"><code>gap-agent.md</code></a></td><td>Draft</td></tr>
<tr><td>6</td><td><strong>Stack Agent</strong></td><td><a href="components/stack-agent.html"><code>stack-agent.md</code></a></td><td>Draft</td></tr>
<tr><td>7</td><td><strong>Report Agent</strong></td><td><a href="components/report-agent.html"><code>report-agent.md</code></a></td><td>Draft</td></tr>
<tr><td>8</td><td><strong>Planner Adapter</strong> (Fast Downward / OPTIC)</td><td><a href="components/planner-adapter.html"><code>planner-adapter.md</code></a></td><td><strong>Spec Complete</strong></td></tr>
<tr><td>9</td><td><strong>RL‑Critic</strong></td><td><a href="components/../ai-sub-system-docs/rl-critic.html"><code>rl-critic.md</code></a></td><td><strong>Spec Complete</strong></td></tr>
<tr><td>10</td><td><strong>WASI Plugin Host</strong></td><td><a href="components/plugin-host.html"><code>plugin-host.md</code></a></td><td>Draft</td></tr>
<tr><td>11</td><td><strong>Weekly Ontology Crawler</strong></td><td><a href="components/ontology-crawler.html"><code>ontology-crawler.md</code></a></td><td>Draft</td></tr>
<tr><td>12</td><td><strong>Telemetry Pipeline</strong></td><td><a href="components/telemetry.html"><code>telemetry.md</code></a></td><td>Draft</td></tr>
<tr><td>13</td><td><strong>Fast Downward Integration</strong></td><td><a href="components/fast-downward-integration.html"><code>fast-downward-integration.md</code></a></td><td><strong>Spec Complete</strong></td></tr>
</tbody></table>
</div>
<blockquote>
<p><strong>Tip:</strong> begin each component doc with its purpose (<em>raison d’être</em>), list any
public structs/traits (Rust) or messages (TypeScript), then finish with
extension examples.</p>
</blockquote>
<hr />
<h2 id="contributing-workflow"><a class="header" href="#contributing-workflow">Contributing Workflow</a></h2>
<ol>
<li><strong>Implement or modify code</strong> in the directory linked to each component.</li>
<li>Update the matching Markdown file in this folder.</li>
<li>Commit <strong>code and docs together</strong>—our CI will fail if headings are missing.</li>
<li>Once a component hits MVP, update its <strong>Status</strong> to <code>🚀 Implemented</code>.</li>
</ol>
<hr />
<h2 id="legend"><a class="header" href="#legend">Legend</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Label</th><th>Meaning</th></tr></thead><tbody>
<tr><td>Draft</td><td>Skeleton doc exists; awaiting API stabilisation.</td></tr>
<tr><td>In Progress</td><td>Active implementation phase.</td></tr>
<tr><td>Spec Complete</td><td>Design locked; implementation upcoming.</td></tr>
<tr><td>🚀 Implemented</td><td>Code merged, tests passing, docs current.</td></tr>
</tbody></table>
</div>
<hr />
<p>See also:</p>
<ul>
<li><a href="components/../ai-platform-overview/ai-platform-overview.html">AI Platform Overview</a></li>
<li><a href="components/../architecture/architecture-overview.html">Architecture Overview</a></li>
<li><a href="components/../ai-sub-system-docs/planner-integration.html">Planner Integration Guide</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><blockquote>
<p><em>Status: Draft — last updated 2025-06-20</em></p>
</blockquote>
<h1 id="stack-agent"><a class="header" href="#stack-agent">Stack Agent</a></h1>
<hr />
<p>See <a href="components/../architecture-and-component-guides/architecture-questions.html">Architecture Questions</a> for open questions and strategic direction.</p>
<p>See also:</p>
<ul>
<li><a href="components/../component-details/gap-agent.html">Gap Agent</a></li>
<li><a href="components/../component-details/report-agent.html">Report Agent</a></li>
</ul>
<p>The <strong>Stack Agent</strong> synthesises one or more candidate technology stacks that
satisfy the fully‑specified requirement graph coming out of the Gap‑Analysis
Agent. It ranks those candidates using a multi‑objective score that balances
licence compatibility, ecosystem maturity, performance, hiring pool and known
security posture. The top‑N proposals are streamed back to the Orchestrator
for user review and report generation.</p>
<hr />
<h2 id="1-responsibilities"><a class="header" href="#1-responsibilities">1 Responsibilities</a></h2>
<div class="table-wrapper"><table><thead><tr><th>#</th><th>Responsibility</th><th>Detail</th></tr></thead><tbody>
<tr><td>1</td><td><strong>Collect evidence</strong></td><td>Query Retrieval Layer for chunks tagged with relevant domains</td></tr>
<tr><td>2</td><td><strong>Generate candidates</strong></td><td>Apply rule‑based templates + LLM “fill gaps” prompt</td></tr>
<tr><td>3</td><td><strong>Invoke planner</strong></td><td>Attach plan cost (time/resource) to each candidate</td></tr>
<tr><td>4</td><td><strong>Score &amp; rank</strong></td><td>Weighted AHP (analytic hierarchy process) + RL‑Critic adjustment</td></tr>
<tr><td>5</td><td><strong>Emit proposals</strong></td><td>Stream <code>Proposal</code> objects to UI for incremental rendering</td></tr>
<tr><td>6</td><td><strong>Telemetry</strong></td><td>Emit <code>stack.proposal</code> and <code>stack.score</code> spans</td></tr>
</tbody></table>
</div>
<hr />
<h2 id="2-data-flow"><a class="header" href="#2-data-flow">2 Data Flow</a></h2>
<pre><code class="language-mermaid">flowchart LR
  R[Requirement Graph] --&gt; E( Evidence Collector )
  E --&gt; G(Candidate Generator)
  G --&gt; P(Planner Adapter)
  P --&gt; S(Scorer)
  S --&gt;|top‑N| ORCH[Orchestrator / UI]
</code></pre>
<p><em>Evidence Collector</em> issues hybrid searches;
<em>Candidate Generator</em> uses both <strong>template rules</strong> and <strong>LLM “slot‑fill”</strong>;
<em>Scorer</em> combines heuristic score + optional RL‑Critic value.</p>
<hr />
<h2 id="3-public-rust-api"><a class="header" href="#3-public-rust-api">3 Public Rust API</a></h2>
<pre><code class="language-rust ignore">use uuid::Uuid;

pub struct TechStack;
pub struct PlanStep;
pub struct RequirementGraph;

pub struct Proposal {
    pub id: Uuid,
    pub stack: TechStack,        // nested langs, frameworks, infra
    pub score: f32,
    pub plan: Vec&lt;PlanStep&gt;,     // optional if planner disabled
    pub rationale: String,       // LLM explanation
}

#[async_trait::async_trait]
pub trait StackAgent {
    async fn propose(requirements: &amp;RequirementGraph, max: usize)
        -&gt; anyhow::Result&lt;Vec&lt;Proposal&gt;&gt;;

    async fn score(proposal: &amp;mut Proposal) -&gt; anyhow::Result&lt;()&gt;;
}</code></pre>
<p><code>TechStack</code> defined in <code>schema/tech_stack.rs</code>.</p>
<hr />
<h2 id="4-scoring-function"><a class="header" href="#4-scoring-function">4 Scoring Function</a></h2>
<p>Total score = Σ ( wᵢ × metricᵢ ) − penalty</p>
<div class="table-wrapper"><table><thead><tr><th>Metric</th><th>Symbol</th><th>Weight (default)</th></tr></thead><tbody>
<tr><td>Licence compatibility</td><td>L</td><td>0.25</td></tr>
<tr><td>Ecosystem maturity (GitHub stars, age)</td><td>M</td><td>0.20</td></tr>
<tr><td>Performance benchmarks</td><td>P</td><td>0.15</td></tr>
<tr><td>Hiring pool size</td><td>H</td><td>0.15</td></tr>
<tr><td>Security track record</td><td>S</td><td>0.15</td></tr>
<tr><td>Planner cost (build time)</td><td>C</td><td>−0.10 (penalty)</td></tr>
</tbody></table>
</div>
<p>Weights are stored in <code>config/stack_agent.toml</code> and adjustable per project.
If RL‑Critic is enabled, its value estimate <em>re‑weights</em> the final score by up
to ±10 %.</p>
<hr />
<h2 id="5-candidate-generation-strategies"><a class="header" href="#5-candidate-generation-strategies">5 Candidate Generation Strategies</a></h2>
<ol>
<li>
<p><strong>Rule‑based templates</strong> (fast, deterministic)
<em>Example</em>: “Web → Language: Rust | JS; Framework: Actix | Next.js …”</p>
</li>
<li>
<p><strong>LLM slot fill</strong> — prompt:</p>
<blockquote>
<p>“Given requirements A, B, C produce <strong>one</strong> complete tech stack as JSON…”</p>
</blockquote>
</li>
<li>
<p><strong>Hybrid</strong> — start with rule template, let LLM propose alternates.</p>
</li>
</ol>
<p>Strategy selected via config: <code>gen_mode = "hybrid"</code>.</p>
<hr />
<h2 id="6-configuration-stack_agenttoml"><a class="header" href="#6-configuration-stack_agenttoml">6 Configuration (<code>stack_agent.toml</code>)</a></h2>
<pre><code class="language-toml">[generator]
mode = "hybrid"        # rule | llm | hybrid
max_candidates = 10

[scoring]
weights = { licence = 0.25, maturity = 0.2, perf = 0.15,
            hiring = 0.15, security = 0.15, plan_cost = -0.1 }

[planner]
enabled = true
timeout_secs = 45
</code></pre>
<hr />
<h2 id="7-extension-hooks"><a class="header" href="#7-extension-hooks">7 Extension Hooks</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Hook</th><th>How</th></tr></thead><tbody>
<tr><td><strong>Custom score metric</strong></td><td>WASI plugin implements <code>fn metric(stack) -&gt; f32</code></td></tr>
<tr><td><strong>New generator strategy</strong></td><td>Register <code>Box&lt;dyn ProposalGenerator&gt;</code></td></tr>
<tr><td><strong>Domain‑specific rules</strong></td><td>TOML file <code>rules/*.toml</code> hot‑loaded on change</td></tr>
</tbody></table>
</div>
<hr />
<h2 id="8-uiux-integration"><a class="header" href="#8-uiux-integration">8 UI/UX Integration</a></h2>
<ul>
<li>Proposals stream into a <strong>card grid</strong>; clicking a card shows rationale,
plan timeline, and licence/security matrix.</li>
<li><strong>Risk badge</strong> colours: green ≥ 0.8, yellow 0.6‑0.79, red &lt; 0.6.</li>
<li>Hover over score shows spider‑chart of metric contributions.</li>
</ul>
<hr />
<h2 id="9-roadmap"><a class="header" href="#9-roadmap">9 Roadmap</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Version</th><th>Feature</th></tr></thead><tbody>
<tr><td>0.5</td><td>Rule + hybrid generator, static AHP scores</td></tr>
<tr><td>0.8</td><td>RL‑Critic adjustment loop</td></tr>
<tr><td>1.0</td><td>Live “what‑if” matrix (UI slider to tweak weights)</td></tr>
<tr><td>1.1</td><td>Feedback‑learning — user star/rank feeds critic</td></tr>
<tr><td>2.0</td><td>Multi‑objective Pareto frontier visualisation</td></tr>
</tbody></table>
</div>
<hr />
<h2 id="10-open-questions"><a class="header" href="#10-open-questions">10 Open Questions</a></h2>
<ul>
<li>Best default weight set for security‑focused industries?</li>
<li>Should plan cost be normalised by team size?</li>
<li>Strategy for detecting circular dependencies in candidate stacks?</li>
</ul>
<hr />
<h2 id="11-usage-example"><a class="header" href="#11-usage-example">11 Usage Example</a></h2>
<pre><code class="language-rust ignore">let mut proposals = stack_agent
    .propose(&amp;req_graph, 5)
    .await?;
for p in &amp;mut proposals {
    stack_agent.score(p).await?;
}</code></pre>
<hr />
<p>See also:</p>
<ul>
<li><a href="components/../component-details/retrieval-layer.html">Retrieval Layer</a></li>
<li><a href="components/../component-details/planner-adapter.html">Planner Adapter</a></li>
<li><a href="components/../ai-sub-system-docs/rl-critic.html">RL Critic</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="ingestion-agent"><a class="header" href="#ingestion-agent">Ingestion Agent</a></h1>
<p><em>Status: Draft — last updated 2025‑06‑20</em>
The <strong>Ingestion Agent</strong> is the first link in the Stack Composer pipeline. It
converts human‑authored project briefs into machine‑actionable chunks ready for
hybrid retrieval and downstream reasoning.</p>
<hr />
<h2 id="1-responsibilities-1"><a class="header" href="#1-responsibilities-1">1 Responsibilities</a></h2>
<div class="table-wrapper"><table><thead><tr><th>#</th><th>Task</th><th>Detail</th></tr></thead><tbody>
<tr><td>1</td><td><strong>File‑type detection</strong></td><td>MIME sniff &amp; magic‑byte inspection.</td></tr>
<tr><td>2</td><td><strong>Text extraction</strong></td><td>PDF, DOCX, Markdown, plaintext; OCR fallback (v 1.1).</td></tr>
<tr><td>3</td><td><strong>Chunking</strong></td><td>Sliding 256‑token windows (64‑token overlap).</td></tr>
<tr><td>4</td><td><strong>Embedding</strong></td><td>Ollama embeddings endpoint; local fastText fallback.</td></tr>
<tr><td>5</td><td><strong>Persistence</strong></td><td>Write chunks into Qdrant &amp; Meilisearch in one transaction.</td></tr>
<tr><td>6</td><td><strong>Ontology enrichment</strong></td><td>Detect new terms → emit <code>OntologyUpdate</code> event.</td></tr>
</tbody></table>
</div>
<hr />
<h2 id="2-data-flow-1"><a class="header" href="#2-data-flow-1">2 Data Flow</a></h2>
<pre><code class="language-mermaid">flowchart LR
  A[Input File] --&gt; B{Detect&lt;br&gt;type}
  B --&gt; C[Extractor]
  C --&gt; D[Chunker&lt;br&gt;256‑tok]
  D --&gt; E[Embedder&lt;br&gt;1536‑D]
  E --&gt;|dense vec| Q[Qdrant]
  D --&gt;|text + meta| M[Meilisearch]
  D --&gt; F{New terms?}
  F -- yes --&gt; O[Ontology Update]
</code></pre>
<hr />
<h2 id="3-extractor-matrix"><a class="header" href="#3-extractor-matrix">3 Extractor Matrix</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Type</th><th>Extractor crate</th><th>Notes</th></tr></thead><tbody>
<tr><td>PDF</td><td><code>pdf_extract</code></td><td>Text‑only; images discarded.</td></tr>
<tr><td>DOCX</td><td><code>mammoth-rs</code></td><td>Preserves headings, lists.</td></tr>
<tr><td>Markdown</td><td><code>pulldown-cmark</code></td><td>Strips code‑fences by default.</td></tr>
<tr><td>TXT</td><td>native <code>std::fs</code> read</td><td>UTF‑8 assumed; BOM handled.</td></tr>
<tr><td>Unsupported</td><td><code>tesseract</code> via CLI (v 1.1)</td><td>OCR fallback.</td></tr>
</tbody></table>
</div>
<hr />
<h2 id="4-chunking-strategy"><a class="header" href="#4-chunking-strategy">4 Chunking Strategy</a></h2>
<ul>
<li><strong>Window = 256 tokens</strong>; <strong>Overlap = 64 tokens</strong> to maximise context reuse.</li>
<li>Implemented in <code>agents/ingestion/src/chunker.rs</code>:</li>
</ul>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>pub fn chunk(tokens: &amp;[u32]) -&gt; Vec&lt;Chunk&gt; {
    tokens
      .chunks(WINDOW)
      .scan(0, |offset, slice| {
          let idx = *offset;
          *offset += WINDOW - OVERLAP;
          Some(Chunk { idx, tokens: slice.to_vec() })
      })
      .collect()
}
<span class="boring">}</span></code></pre></pre>
<hr />
<h2 id="5-public-api"><a class="header" href="#5-public-api">5 Public API</a></h2>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>pub struct IngestResult {
    pub chunk_ids: Vec&lt;Uuid&gt;,
    pub meta: DocMeta,
}

#[async_trait]
pub trait IngestionAgent {
    async fn ingest(path: PathBuf) -&gt; anyhow::Result&lt;IngestResult&gt;;
    async fn shutdown() -&gt; anyhow::Result&lt;()&gt;;
}
<span class="boring">}</span></code></pre></pre>
<h3 id="cli-usage"><a class="header" href="#cli-usage">CLI Usage</a></h3>
<pre><code class="language-bash">stack-composer ingest brief.pdf --json
</code></pre>
<hr />
<h2 id="6-extension-hooks"><a class="header" href="#6-extension-hooks">6 Extension Hooks</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Hook</th><th>How to implement</th></tr></thead><tbody>
<tr><td><strong>New file format</strong></td><td>WASI plugin exports <code>fn extract(bytes) -&gt; String</code>.</td></tr>
<tr><td><strong>Custom chunker</strong></td><td>Register <code>Box&lt;dyn Chunker&gt;</code> via plugin manifest.</td></tr>
<tr><td><strong>Pre‑processing pipeline</strong></td><td>Add <code>preprocess.rs</code> in plugin; receives raw text.</td></tr>
</tbody></table>
</div>
<hr />
<h2 id="7-configuration-ingestiontoml"><a class="header" href="#7-configuration-ingestiontoml">7 Configuration (<code>ingestion.toml</code>)</a></h2>
<pre><code class="language-toml">[chunking]
window_tokens  = 256
overlap_tokens = 64

[embedding]
provider  = "ollama"
model     = "phi3-embedding"
timeout_ms = 5000
</code></pre>
<hr />
<h2 id="8-roadmap"><a class="header" href="#8-roadmap">8 Roadmap</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Version</th><th>Feature</th></tr></thead><tbody>
<tr><td>0.5</td><td>Core extract‑chunk‑embed‑persist (this spec)</td></tr>
<tr><td>0.8</td><td>Parallel ingestion jobs; progress bar UI</td></tr>
<tr><td>1.0</td><td>OCR fallback (tesseract)</td></tr>
<tr><td>1.2</td><td>Clustered ingestion (gRPC)</td></tr>
<tr><td>2.0</td><td>Incremental re‑ingest &amp; delta detection</td></tr>
</tbody></table>
</div>
<hr />
<h2 id="9-open-questions"><a class="header" href="#9-open-questions">9 Open Questions</a></h2>
<ul>
<li>Should the extractor preserve images for future multimodal models?</li>
<li>Strategy for deduping near‑identical chunks across multiple briefs?</li>
</ul>
<hr />
<h2 id="10-usage-example"><a class="header" href="#10-usage-example">10 Usage Example</a></h2>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>let res = ingestion_agent.ingest(PathBuf::from("spec.docx")).await?;
println!("{} chunks stored", res.chunk_ids.len());
<span class="boring">}</span></code></pre></pre>
<hr />
<p>See also:</p>
<ul>
<li><a href="components/retrieval-layer.html">Retrieval Layer</a></li>
<li><a href="components/gap-agent.html">Gap‑Analysis Agent</a></li>
<li><a href="components/../ai-sub-system-docs/rag-design.html">RAG Design</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="llm-runtime-abstraction"><a class="header" href="#llm-runtime-abstraction">LLM Runtime Abstraction</a></h1>
<p><em>Status · Spec Complete — last updated 2025‑06‑20</em>
The <strong>LLM Runtime</strong> decouples Stack Composer’s agents from any specific
large‑language‑model back‑end. It hides networking, model hot‑swap, streaming,
and error‑handling behind a single trait so you can swap Ollama for vLLM, LM Studio, or Hugging Face TGI without touching business logic.</p>
<hr />
<h2 id="1-responsibilities-2"><a class="header" href="#1-responsibilities-2">1 Responsibilities</a></h2>
<div class="table-wrapper"><table><thead><tr><th>#</th><th>Responsibility</th><th>Notes</th></tr></thead><tbody>
<tr><td>1</td><td><strong>Provider abstraction</strong></td><td>Ollama (default), vLLM, LM Studio, HF TGI</td></tr>
<tr><td>2</td><td><strong>Model lifecycle</strong></td><td>pull → check hash → load → unload</td></tr>
<tr><td>3</td><td><strong>Streaming inference</strong></td><td>Tokio async stream of token deltas</td></tr>
<tr><td>4</td><td><strong>Back‑pressure &amp; retries</strong></td><td>Rate‑limit queue; exponential back‑off</td></tr>
<tr><td>5</td><td><strong>Auth &amp; proxy</strong></td><td>OpenAI‑style <code>Authorization</code> header; HTTPS proxy support</td></tr>
<tr><td>6</td><td><strong>Telemetry hooks</strong></td><td>Emit OpenTelemetry spans: <code>llm.request</code>, <code>llm.token</code></td></tr>
</tbody></table>
</div>
<hr />
<h2 id="2-public-trait"><a class="header" href="#2-public-trait">2 Public Trait</a></h2>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>#[async_trait]
pub trait LlmProvider: Send + Sync {
    /// Streamed chat completion.
    async fn chat(
        &amp;self,
        req: ChatRequest,
    ) -&gt; anyhow::Result&lt;Pin&lt;Box&lt;dyn Stream&lt;Item = TokenDelta&gt; + Send&gt;&gt;&gt;;

    /// Embedding endpoint (optional; falls back to fastText).
    async fn embed(&amp;self, input: &amp;str) -&gt; anyhow::Result&lt;Vec&lt;f32&gt;&gt;;

    /// List local and remote models with meta.
    async fn models(&amp;self) -&gt; anyhow::Result&lt;Vec&lt;ModelInfo&gt;&gt;;
}
<span class="boring">}</span></code></pre></pre>
<p>Default provider = <strong><code>OllamaProvider</code></strong> (file: <code>providers/ollama.rs</code>).</p>
<hr />
<h2 id="3-provider-matrix"><a class="header" href="#3-provider-matrix">3 Provider Matrix</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Provider</th><th>Transport</th><th>Streaming</th><th>Embeddings</th><th>Notes</th></tr></thead><tbody>
<tr><td><strong>Ollama</strong></td><td>REST 11434</td><td>✔ SSE</td><td>✔</td><td>Bundled installer script</td></tr>
<tr><td><strong>vLLM</strong></td><td>HTTP 8000</td><td>✔ (SSE)</td><td>✔</td><td>Requires CUDA; opt‑in</td></tr>
<tr><td><strong>LM Studio</strong></td><td>HTTP 1234</td><td>✔ SSE</td><td>✖ — uses text endpoint</td><td>Desktop GUI must be running</td></tr>
<tr><td><strong>HF TGI</strong></td><td>HTTP 8080</td><td>✔ SSE</td><td>✔</td><td>GPU heavy; cloud or Docker</td></tr>
</tbody></table>
</div>
<hr />
<h2 id="4-runtime-flow"><a class="header" href="#4-runtime-flow">4 Runtime Flow</a></h2>
<pre><code class="language-mermaid">sequenceDiagram
  participant Agent
  participant Orchestrator
  participant LlmProvider
  Agent-&gt;&gt;Orchestrator: ChatRequest
  Orchestrator-&gt;&gt;LlmProvider: .chat(req)
  LlmProvider--&gt;&gt;Orchestrator: TokenΔ stream
  Orchestrator--&gt;&gt;Agent: forward deltas
</code></pre>
<p>Failures propagate as <code>LlmError::{Timeout, ProviderDown, ModelNotFound}</code>.</p>
<hr />
<h2 id="5-configuration-llmtoml"><a class="header" href="#5-configuration-llmtoml">5 Configuration (<code>llm.toml</code>)</a></h2>
<pre><code class="language-toml">[defaults]
provider = "ollama"
model    = "phi3:4b-instruct"

[ollama]
endpoint = "http://localhost:11434"
timeout_ms = 80000

[vllm]
endpoint = "http://localhost:8000"
max_input_tokens = 8192
</code></pre>
<p>CLI overrides: <code>--llm provider=vllm model=phi3:8b</code>.</p>
<hr />
<h2 id="6-security--sandbox"><a class="header" href="#6-security--sandbox">6 Security &amp; Sandbox</a></h2>
<ul>
<li>HTTPS proxy honoured via <code>HTTPS_PROXY</code> env.</li>
<li>Request/response JSON logged only when <code>SC_DEBUG=llm</code>.</li>
<li>Tokens never stored; only usage stats emit to Telemetry.</li>
</ul>
<hr />
<h2 id="7-benchmarks"><a class="header" href="#7-benchmarks">7 Benchmarks</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Provider</th><th>Model</th><th>p50 latency (256 tok)</th><th>RAM (RSS)</th></tr></thead><tbody>
<tr><td>Ollama</td><td>phi‑3 4b</td><td>0.9 s</td><td>2 GB</td></tr>
<tr><td>vLLM CUDA A10</td><td>phi‑3 8b</td><td>0.12 s</td><td>5 GB GPU</td></tr>
<tr><td>LM Studio CPU</td><td>mistral‑7b Q4</td><td>1.5 s</td><td>6 GB</td></tr>
<tr><td>HF TGI GPU</td><td>llama‑3 8b</td><td>0.11 s</td><td>7 GB GPU</td></tr>
</tbody></table>
</div>
<p>Bench script: <code>benches/llm_bench.rs</code>.</p>
<hr />
<h2 id="8-extension-hooks"><a class="header" href="#8-extension-hooks">8 Extension Hooks</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Hook</th><th>How</th></tr></thead><tbody>
<tr><td><strong>New provider</strong></td><td>Implement <code>LlmProvider</code>; register with <code>ProviderRegistry::add</code>.</td></tr>
<tr><td><strong>Prompt template</strong></td><td>WASI plugin can override <code>system</code> &amp; <code>suffix</code>.</td></tr>
<tr><td><strong>Token filters</strong></td><td>Provide closure in <code>Settings ▸ Advanced ▸ Token Hook</code>.</td></tr>
</tbody></table>
</div>
<hr />
<h2 id="9-roadmap-1"><a class="header" href="#9-roadmap-1">9 Roadmap</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Version</th><th>Feature</th></tr></thead><tbody>
<tr><td>0.5</td><td>Ollama provider + model auto‑pull</td></tr>
<tr><td>0.8</td><td>vLLM &amp; HF TGI adapters</td></tr>
<tr><td>1.0</td><td>Hot‑swap without losing context</td></tr>
<tr><td>1.1</td><td>Multi‑model routing by agent role</td></tr>
<tr><td>2.0</td><td>On‑device LoRA fine‑tune API</td></tr>
</tbody></table>
</div>
<hr />
<h2 id="10-faq"><a class="header" href="#10-faq"> 10 FAQ</a></h2>
<p><strong>What happens if no provider is running?</strong>
Model probe (see Usage § 7) prompts install or remote API key.</p>
<p><strong>Does the runtime cache embeddings?</strong>
Yes, SQLite BLOB cache keyed by SHA‑256 of input.</p>
<p><strong>How are prompts escaped?</strong>
<code>serde_json::to_string</code> wraps user content to guard against prompt‑injection.</p>
<hr />
<p>See also:</p>
<ul>
<li><a href="components/retrieval-layer.html">Retrieval Layer</a></li>
<li><a href="components/../ai-sub-system-docs/planner-integration.html">Planner Integration</a></li>
<li><a href="components/../plugin-sdk/README.html">Plugin SDK</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="ontology-crawler-overview"><a class="header" href="#ontology-crawler-overview">Ontology Crawler Overview</a></h1>
<h2 id="responsibilities"><a class="header" href="#responsibilities">Responsibilities</a></h2>
<ul>
<li>Refresh and update the knowledge base/ontology</li>
<li>Schedule and run periodic crawls</li>
<li>Integrate new data into the system</li>
</ul>
<h2 id="public-apis"><a class="header" href="#public-apis">Public APIs</a></h2>
<ul>
<li><code>run_crawl() -&gt; Result</code></li>
<li><code>update_schedule(cron: str)</code></li>
</ul>
<h2 id="extension-hooks"><a class="header" href="#extension-hooks">Extension Hooks</a></h2>
<ul>
<li>Support for new data sources</li>
<li>Custom scheduling logic</li>
</ul>
<h2 id="roadmap--enhancements"><a class="header" href="#roadmap--enhancements">Roadmap &amp; Enhancements</a></h2>
<ul>
<li>Ontology versioning and updates</li>
<li>Validation workflow (UI/CLI) for vetting updates</li>
<li>Distributed updates for multi-node/clustered refresh</li>
</ul>
<h2 id="open-questions"><a class="header" href="#open-questions">Open Questions</a></h2>
<ul>
<li>How to handle failed or partial crawls?</li>
<li>What is the best way to notify users of updates?</li>
</ul>
<h2 id="how-to-extendcustomize"><a class="header" href="#how-to-extendcustomize">How to Extend/Customize</a></h2>
<ul>
<li>Add new data source connectors via plugin</li>
<li>Implement custom crawl strategies</li>
</ul>
<h2 id="real-world-usage-example"><a class="header" href="#real-world-usage-example">Real-World Usage Example</a></h2>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>weekly_crawler.run_crawl();
<span class="boring">}</span></code></pre></pre>
<hr />
<p>See <a href="components/../architecture/architecture-questions.html">Architecture Questions</a> for open questions and strategic direction.</p>
<p><em>See also: <a href="components/../architecture-and-component-guides/architecture-questions.html">Ontology/Knowledge Graph</a></em></p>
<h2 id="weekly-ontology-crawler"><a class="header" href="#weekly-ontology-crawler">Weekly Ontology Crawler</a></h2>
<p><em>Status: Draft — last updated 2025‑06‑20</em>
The <strong>Ontology Crawler</strong> (OC) keeps Stack Composer’s knowledge base fresh by
ingesting release notes, security advisories, and package‑registry metadata into
the hybrid RAG store each week. It runs as a scheduled background task, fully
offline‑capable and sand‑boxed.</p>
<hr />
<h2 id="1-responsibilities-3"><a class="header" href="#1-responsibilities-3">1 Responsibilities</a></h2>
<div class="table-wrapper"><table><thead><tr><th>#</th><th>Task</th><th>Detail</th></tr></thead><tbody>
<tr><td>1</td><td><strong>Schedule periodic jobs</strong></td><td>Default cron <code>0 3 * * 0</code> (Sun 03:00 local).</td></tr>
<tr><td>2</td><td><strong>Fetch data sources</strong></td><td>GitHub release RSS, NVD CVE JSON feeds, crates.io / npm REST.</td></tr>
<tr><td>3</td><td><strong>Deduplicate &amp; diff</strong></td><td>SHA‑256 hashes; only new artefacts embedded.</td></tr>
<tr><td>4</td><td><strong>Embed &amp; persist</strong></td><td>Use LLM embedder ➜ Qdrant + Meilisearch hybrid store.</td></tr>
<tr><td>5</td><td><strong>Licence tagging</strong></td><td>Parse SPDX id; block non‑OSI licences pre‑insert.</td></tr>
<tr><td>6</td><td><strong>Emit telemetry &amp; events</strong></td><td><code>oc.crawl.start</code>, <code>oc.crawl.success/fail</code>.</td></tr>
</tbody></table>
</div>
<hr />
<h2 id="2-architecture--data-flow"><a class="header" href="#2-architecture--data-flow">2 Architecture &amp; Data Flow</a></h2>
<pre><code class="language-mermaid">flowchart TD
  subgraph Crawler Job
    A[Source List] --&gt; F[Fetcher]
    F --&gt; D[Deduper]
    D --&gt; P[Pre‑processor]
    P --&gt; E[Embed &amp; Insert]
  end
  E --&gt;|Chunk + meta| Q[Qdrant]
  E --&gt; M[Meilisearch]
  D --&gt;|New term event| O[OntologyUpdate]
</code></pre>
<ul>
<li><strong>Fetcher</strong> supports HTTP(S), RSS/Atom, gzip JSON.</li>
<li><strong>Pre‑processor</strong> strips HTML, YAML front‑matter, Markdown code fences.</li>
</ul>
<hr />
<h2 id="3-source-configuration-crawlertoml"><a class="header" href="#3-source-configuration-crawlertoml">3 Source Configuration (<code>crawler.toml</code>)</a></h2>
<pre><code class="language-toml">[schedule]
cron = "0 3 * * 0"

[sources]
github_rss = [
  "https://github.com/rust-lang/rust/releases.atom",
  "https://github.com/facebook/react/releases.atom"
]
nvd_cve_json = "https://nvd.nist.gov/feeds/json/cve/1.1/nvdcve-1.1-recent.json.gz"
npm_api      = "https://registry.npmjs.org/-/v1/search?text=keywords:framework"
crates_api   = "https://crates.io/api/v1/crates?page=1&amp;per_page=100"
</code></pre>
<p>Add/remove sources via Settings ▸ Ontology ▸ Data Sources.</p>
<hr />
<h2 id="4-public-api"><a class="header" href="#4-public-api">4 Public API</a></h2>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>pub struct CrawlStats {
    pub docs_inserted: u32,
    pub duplicates_skipped: u32,
    pub duration_ms: u128,
}

#[async_trait]
pub trait OntologyCrawler {
    async fn run_crawl(manual: bool) -&gt; anyhow::Result&lt;CrawlStats&gt;;
    async fn update_schedule(cron: &amp;str) -&gt; anyhow::Result&lt;()&gt;;
}
<span class="boring">}</span></code></pre></pre>
<p>Manual flag bypasses cron; useful in CI or test.</p>
<hr />
<h2 id="5-scheduler-implementation"><a class="header" href="#5-scheduler-implementation">5 Scheduler Implementation</a></h2>
<ul>
<li>Uses <code>tokio-cron-scheduler</code>.</li>
<li>Misfire policy: run immediately if last missed by &gt;24 h.</li>
<li>Jobs run in a separate Tokio runtime with <code>ulimit -n 512</code>.</li>
</ul>
<hr />
<h2 id="6-security--sandboxing"><a class="header" href="#6-security--sandboxing">6 Security &amp; Sandboxing</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Concern</th><th>Mitigation</th></tr></thead><tbody>
<tr><td>Malicious JSON/rss</td><td><code>serde_json</code> &amp; <code>quick-xml</code> with size cap 5 MB/file.</td></tr>
<tr><td>Network exposure</td><td>Proxy honoured via <code>HTTPS_PROXY</code>; offline mode denies fetch.</td></tr>
<tr><td>Licences</td><td>Non‑OSI ids are dropped before persistence.</td></tr>
<tr><td>Secrets</td><td>Values like <code>ghp_</code> tokens redacted via regex.</td></tr>
</tbody></table>
</div>
<hr />
<h2 id="7-extension-hooks-1"><a class="header" href="#7-extension-hooks-1">7 Extension Hooks</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Hook</th><th>How</th></tr></thead><tbody>
<tr><td><strong>New source plugin</strong></td><td>WASI plugin exports <code>fn fetch() -&gt; Vec&lt;Artifact&gt;</code>.</td></tr>
<tr><td><strong>Custom scheduler</strong></td><td>Replace <code>tokio-cron</code> with plugin’s <code>next_run()</code> impl.</td></tr>
<tr><td><strong>Transform pipeline</strong></td><td>Insert middleware via plugin manifest ordering.</td></tr>
</tbody></table>
</div>
<hr />
<h2 id="8-monitoring--telemetry"><a class="header" href="#8-monitoring--telemetry">8 Monitoring &amp; Telemetry</a></h2>
<ul>
<li>OpenTelemetry spans: <code>oc.fetch</code>, <code>oc.embed</code>, <code>oc.insert</code>.</li>
<li>Logs in <code>~/.local/share/stack-composer/logs/oc-*.log</code>.</li>
<li>Dashboard card shows last run, docs added, next run countdown.</li>
</ul>
<hr />
<h2 id="9-roadmap-2"><a class="header" href="#9-roadmap-2">9 Roadmap</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Version</th><th>Feature</th></tr></thead><tbody>
<tr><td>0.5</td><td>Single‑threaded weekly crawl (this spec)</td></tr>
<tr><td>0.8</td><td>Incremental updates + OCI plugin registry ingestion</td></tr>
<tr><td>1.0</td><td>Distributed crawl across LAN (gRPC)</td></tr>
<tr><td>1.1</td><td>Signed artefact verification (in‑toto)</td></tr>
<tr><td>2.0</td><td>Graph diff visualiser &amp; rollback UI</td></tr>
</tbody></table>
</div>
<hr />
<h2 id="10-faq-1"><a class="header" href="#10-faq-1">10 FAQ</a></h2>
<p><strong>What if a crawl fails mid‑way?</strong>
Partial inserts are rolled back via SQLite WAL transaction; last success time
remains unchanged.</p>
<p><strong>Can I run the crawler head‑less?</strong>
Yes: <code>stack-composer crawl --once --json</code>.</p>
<p><strong>How to add a private source that needs auth?</strong>
Set <code>SC_CRAWLER_TOKEN_&lt;ID&gt;</code> env variable and reference <code>&lt;ID&gt;</code> in <code>crawler.toml</code>
source URL.</p>
<hr />
<p>See also:</p>
<ul>
<li><a href="components/../ai-sub-system-docs/rag-design.html">RAG Design</a></li>
<li><a href="components/ingestion-agent.html">Ingestion Agent</a></li>
<li><a href="components/telemetry.html">Telemetry Pipeline</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><blockquote>
<p><em>Status: In Progress – last updated 2025‑06‑20</em></p>
</blockquote>
<h1 id="rust-orchestrator"><a class="header" href="#rust-orchestrator">Rust Orchestrator</a></h1>
<p>The <strong>Orchestrator</strong> is the beating heart of Stack Composer.<br />
It spawns, supervises and connects every agent and long‑running service, while
presenting a single, language‑agnostic IPC surface to the UI, CLI, and any
automation clients.</p>
<hr />
<h2 id="1-responsibilities-4"><a class="header" href="#1-responsibilities-4">1 Responsibilities</a></h2>
<div class="table-wrapper"><table><thead><tr><th>#</th><th>Responsibility</th><th>Implementation Notes</th></tr></thead><tbody>
<tr><td>1</td><td><strong>Lifecycle</strong> – start/stop agents &amp; services</td><td>Tokio work‑stealing runtime; dynamic supervisor tree</td></tr>
<tr><td>2</td><td><strong>Routing</strong> – async message bus</td><td><code>tokio::mpsc</code> channels keyed by <code>AgentId</code></td></tr>
<tr><td>3</td><td><strong>Plugin hand‑off</strong></td><td>Attach WASI capability tokens; forward host calls</td></tr>
<tr><td>4</td><td><strong>IPC façade</strong></td><td>gRPC bidirectional stream for Tauri UI; JSON over stdio for headless</td></tr>
<tr><td>5</td><td><strong>Health &amp; metrics</strong></td><td><code>/healthz</code> HTTP endpoint; OpenTelemetry spans</td></tr>
<tr><td>6</td><td><strong>Config hot‑reload</strong></td><td>Watch <code>*.toml</code>; diff → live update without restart</td></tr>
<tr><td>7</td><td><strong>Graceful shutdown</strong></td><td>Fan‑out <code>Shutdown</code> message, await tasks, flush WALs</td></tr>
</tbody></table>
</div>
<hr />
<h2 id="2-highlevel-architecture"><a class="header" href="#2-highlevel-architecture">2 High‑level Architecture</a></h2>
<pre><code class="language-mermaid">flowchart TD
  subgraph Orchestrator
    API[gRPC / stdio API] --&gt; BUS((Async Bus))
    BUS --&gt; A[Ingestion Agent]
    BUS --&gt; G[Gap Agent]
    BUS --&gt; S[Stack Agent]
    BUS --&gt; R[Report Agent]
    BUS --&gt; P[Planner Adapter]
    BUS --&gt; C[RL Critic]
    BUS --&gt; W[WASI Plugin Host]
  end
  UI[Tauri UI] -- gRPC --&gt; API
  CLI[Headless CLI] -- stdio JSON --&gt; API
</code></pre>
<p><em>Every arrow = non‑blocking channel; buffer size defaults to <code>512</code>.</em></p>
<hr />
<h2 id="3-key-apis"><a class="header" href="#3-key-apis">3 Key APIs</a></h2>
<h3 id="31-agent-registry"><a class="header" href="#31-agent-registry">3.1 Agent Registry</a></h3>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>type AgentId = String;

pub trait AgentHandle: Send + Sync {
    fn id(&amp;self) -&gt; &amp;AgentId;
    async fn send(&amp;self, msg: AgentMsg) -&gt; anyhow::Result&lt;()&gt;;
}

pub struct Orchestrator {
    registry: DashMap&lt;AgentId, Box&lt;dyn AgentHandle&gt;&gt;,
}
<span class="boring">}</span></code></pre></pre>
<h3 id="32-public-ipc-grpc"><a class="header" href="#32-public-ipc-grpc">3.2 Public IPC (gRPC)</a></h3>
<p>* <code>orchestrator.proto</code> owns two bidirectional streams:</p>
<pre><code class="language-protobuf">service Orchestrator {
  rpc Command(stream CommandReq) returns (stream CommandRes);
  rpc Events(Empty) returns (stream Event);
}
</code></pre>
<p>* Commands mutate state; Events are broadcast (e.g., “PlannerDone”).</p>
<hr />
<h2 id="4-configuration-orchestratortoml"><a class="header" href="#4-configuration-orchestratortoml">4 Configuration (<code>orchestrator.toml</code>)</a></h2>
<pre><code class="language-toml">[general]
max_concurrent_agents = 12
shutdown_timeout_secs = 15

[ipc]
grpc_port = 5123
stdio_json = true

[logging]
level = "info"           # trace|debug|info|warn|error
file  = "~/.local/share/stack-composer/logs/orch.log"
</code></pre>
<p>Reload on file‑change via <code>notify</code> crate; fields that can’t reload (e.g.,
<code>grpc_port</code>) trigger “restart‑needed” event.</p>
<hr />
<h2 id="5-extension-hooks"><a class="header" href="#5-extension-hooks">5 Extension Hooks</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Hook</th><th>Description</th></tr></thead><tbody>
<tr><td><strong><code>PluginInit</code></strong></td><td>WASI plugin registers new host fns; orchestrator adds to capability table</td></tr>
<tr><td><strong><code>AgentFactory</code></strong></td><td>Tests or plugins can inject mock agents at runtime</td></tr>
<tr><td><strong><code>Middleware</code></strong></td><td>Intercept <code>AgentMsg</code> (e.g., for tracing or throttling)</td></tr>
</tbody></table>
</div>
<hr />
<h2 id="6-security-considerations"><a class="header" href="#6-security-considerations">6 Security Considerations</a></h2>
<p>*All plugin calls execute in Wasmtime sandbox; orchestrator binds only allowed
host functions.<br />
* gRPC port listens on <code>127.0.0.1</code> by default; set <code>--grpc-bind 0.0.0.0</code> to
expose.<br />
_ Sensitive config values (tokens) loaded from <code>$SC*SECRET*_</code> env vars.</p>
<hr />
<h2 id="7-metrics--observability"><a class="header" href="#7-metrics--observability">7 Metrics &amp; Observability</a></h2>
<p>*OpenTelemetry spans: <code>orch.agent.spawn</code>, <code>orch.msg.send</code>, <code>orch.shutdown</code>.<br />
* Prometheus exporter (<code>/metrics</code> on port <code>9134</code>) summarises per‑agent mailbox
depth and task count.<br />
* <code>orch doctor</code> CLI prints live status table.</p>
<hr />
<h2 id="8-roadmap--enhancements"><a class="header" href="#8-roadmap--enhancements">8 Roadmap &amp; Enhancements</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Version</th><th>Planned Feature</th></tr></thead><tbody>
<tr><td>0.5</td><td>Core async bus, gRPC façade, health endpoint</td></tr>
<tr><td>0.8</td><td>Hot‑reload config, dynamic plugin host attach</td></tr>
<tr><td>1.0</td><td>Cluster mode: orchestrator ⇄ orchestrator gRPC federation</td></tr>
<tr><td>1.1</td><td>REST proxy &amp; WebSocket events for web clients</td></tr>
<tr><td>2.0</td><td>Kubernetes operator for multi‑node orchestration</td></tr>
</tbody></table>
</div>
<hr />
<h2 id="9-implementation-guide"><a class="header" href="#9-implementation-guide">9 Implementation Guide</a></h2>
<p>1. Entry point <code>crates/orchestrator/src/main.rs</code> builds <code>Builder</code> then <code>run()</code>.<br />
2. Unit tests (<code>tests/</code>) pause tokio clock → deterministic timeouts.<br />
3. Benchmarks (<code>benches/</code>) use <code>criterion</code> to measure 10 k msg/s throughput.<br />
4. Use <code>just orch-dev</code> to start orchestrator standalone with hot‑reload.</p>
<hr />
<h2 id="10-faq-2"><a class="header" href="#10-faq-2">10 FAQ</a></h2>
<p><strong>How do I add a new agent?</strong><br />
Implement <code>AgentHandle</code>, register via <code>orchestrator.add_agent()</code> at start‑up.</p>
<p><strong>Can I embed orchestrator in another process?</strong><br />
Yes—link <code>orchestrator</code> crate, call <code>Builder::default().run_embedded()</code>.</p>
<p><strong>What happens on panic inside an agent?</strong><br />
Supervisor restarts task up to 3 times, then marks agent unhealthy and emits
<code>AgentCrashed</code> event.</p>
<hr />
<p>See also:<br />
*<a href="components/gap-agent.html">Gap‑Analysis Agent</a><br />
* <a href="components/../ai-sub-system-docs/planner-integration.html">Planner Integration</a></p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="planner-adapter-fast-downward--optic"><a class="header" href="#planner-adapter-fast-downward--optic">Planner Adapter (Fast Downward / OPTIC)</a></h1>
<blockquote>
<p><strong>See also:</strong> <a href="components/fast-downward-integration.html">Fast Downward Integration</a></p>
</blockquote>
<h2 id="responsibilities-1"><a class="header" href="#responsibilities-1">Responsibilities</a></h2>
<ul>
<li>Invoke external planners (Fast Downward, OPTIC) for PDDL planning</li>
<li>Translate requirements into domain/problem files</li>
<li>Return plan steps to orchestrator</li>
</ul>
<h2 id="public-apis-1"><a class="header" href="#public-apis-1">Public APIs</a></h2>
<ul>
<li><code>plan(domain: File, problem: File) -&gt; Plan</code></li>
<li><code>validate_plan(plan: Plan) -&gt; bool</code></li>
</ul>
<h2 id="extension-hooks-1"><a class="header" href="#extension-hooks-1">Extension Hooks</a></h2>
<ul>
<li>Support for new planners</li>
<li>Custom plan validation logic</li>
</ul>
<h2 id="roadmap--enhancements-1"><a class="header" href="#roadmap--enhancements-1">Roadmap &amp; Enhancements</a></h2>
<ul>
<li>Canonical PDDL test suite</li>
<li>REST endpoints for planning</li>
<li>Plan visualization &amp; editor (UI)</li>
<li>Pluggable planners and adapters</li>
</ul>
<h2 id="open-questions-1"><a class="header" href="#open-questions-1">Open Questions</a></h2>
<ul>
<li>How to generalize for multiple planners?</li>
<li>What is the best UI for plan visualization?</li>
</ul>
<h2 id="how-to-extendcustomize-1"><a class="header" href="#how-to-extendcustomize-1">How to Extend/Customize</a></h2>
<ul>
<li>Add a new planner adapter by implementing the planner trait</li>
<li>Register new planners via configuration</li>
</ul>
<h2 id="real-world-usage-example-1"><a class="header" href="#real-world-usage-example-1">Real-World Usage Example</a></h2>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>let plan = planner_adapter.plan(domain_file, problem_file);
<span class="boring">}</span></code></pre></pre>
<hr />
<p>See <a href="components/../architecture-and-component-guides/architecture-questions.html">Architecture Questions</a> for open questions and strategic direction.</p>
<p><em>See also: <a href="components/../component-details/stack-agent.html">Stack Agent</a>, <a href="components/../component-details/retrieval-layer.html">Retrieval Layer</a></em></p>
<h1 id="planner-adapter-fast-downward--optic-1"><a class="header" href="#planner-adapter-fast-downward--optic-1">Planner Adapter (Fast Downward / OPTIC)</a></h1>
<p><em>Status: Spec Complete — last updated 2025‑06‑20</em><br />
The <strong>Planner Adapter</strong> isolates Stack Composer from the details of any
external PDDL‑capable planner. In v0.5 two adapters are bundled:</p>
<ul>
<li><strong>Fast Downward</strong> — classical STRIPS planner with GPL‑2 exception.</li>
<li><strong>OPTIC</strong> — temporal/cost extension fork.</li>
</ul>
<p>Both run as <strong>sub‑processes</strong> in a tmpfs jail so licence‑linking issues are
avoided.</p>
<hr />
<h2 id="1-responsibilities-5"><a class="header" href="#1-responsibilities-5">1 Responsibilities</a></h2>
<div class="table-wrapper"><table><thead><tr><th>#</th><th>Task</th><th>Implementation</th></tr></thead><tbody>
<tr><td>1</td><td>Translate requirement graph → <code>domain.pddl</code> + <code>problem.pddl</code></td><td><code>pddl_gen.rs</code></td></tr>
<tr><td>2</td><td>Spawn planner CLI with timeout</td><td><code>Command::new()</code> + Tokio <code>kill_on_drop</code></td></tr>
<tr><td>3</td><td>Parse plan file to JSON <code>PlanStep</code></td><td>Supports FD <code>plan.txt</code> &amp; OPTIC XML</td></tr>
<tr><td>4</td><td>Validate plan against schema</td><td><code>validate_plan()</code> rejects missing actions</td></tr>
<tr><td>5</td><td>Return plan to Orchestrator</td><td><code>AgentMsg::PlanReady(plan)</code></td></tr>
<tr><td>6</td><td>Emit telemetry spans</td><td><code>plan.spawn</code>, <code>plan.parse</code></td></tr>
</tbody></table>
</div>
<hr />
<h2 id="2-public-apis"><a class="header" href="#2-public-apis">2 Public APIs</a></h2>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>pub struct PlanStep {
    pub action: String,
    pub params: Vec&lt;String&gt;,
    pub cost: f32,
    pub start_time: Option&lt;f32&gt;, // OPTIC only
    pub end_time:   Option&lt;f32&gt;,
}

#[async_trait]
pub trait PlannerAdapter {
    async fn plan(
        &amp;self,
        domain: &amp;Path,
        problem: &amp;Path,
        timeout: Duration,
    ) -&gt; anyhow::Result&lt;Vec&lt;PlanStep&gt;&gt;;

    fn validate_plan(&amp;self, plan: &amp;[PlanStep]) -&gt; bool;
}
<span class="boring">}</span></code></pre></pre>
<p>Default implementation = <code>FastDownwardAdapter</code> in
<code>crates/planner-adapter/src/fd_adapter.rs</code>.</p>
<hr />
<h2 id="3-cli-wrappers"><a class="header" href="#3-cli-wrappers">3 CLI Wrappers</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Adapter</th><th>Binary</th><th>Example</th></tr></thead><tbody>
<tr><td>Fast Downward</td><td><code>fast-downward.py</code></td><td><code>fd_adapter solve domain.pddl problem.pddl --timeout 60</code></td></tr>
<tr><td>OPTIC</td><td><code>optic.py</code></td><td><code>optic_adapter solve domain.pddl problem.pddl --timeout 60</code></td></tr>
</tbody></table>
</div>
<p>Both wrappers emit <strong>identical</strong> JSON so orchestrator can switch freely.</p>
<hr />
<h2 id="4-configuration-plannertoml"><a class="header" href="#4-configuration-plannertoml">4 Configuration (<code>planner.toml</code>)</a></h2>
<pre><code class="language-toml">[fast_downward]
binary = "/usr/local/bin/fast-downward.py"
alias  = "seq-sat-lmcut"
timeout_secs = 60

[optic]
binary = "/opt/optic/optic.py"
timeout_secs = 60

[defaults]
select_by_problem = true  # auto‑detect :durative‑action
</code></pre>
<p>Override per run:</p>
<pre><code class="language-bash">stack-composer --planner optic --planner-timeout 120
</code></pre>
<hr />
<h2 id="5-extension-hooks-1"><a class="header" href="#5-extension-hooks-1">5 Extension Hooks</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Hook</th><th>How to use</th></tr></thead><tbody>
<tr><td><strong>New planner</strong></td><td>Implement <code>PlannerAdapter</code>, add to <code>registry.rs</code></td></tr>
<tr><td><strong>Custom PDDL transformer</strong></td><td>WASI plugin can override <code>pddl_gen.rs</code></td></tr>
<tr><td><strong>Plan validator</strong></td><td>Replace <code>validate_plan()</code> to enforce org‑specific rules</td></tr>
</tbody></table>
</div>
<hr />
<h2 id="6-testing"><a class="header" href="#6-testing">6 Testing</a></h2>
<ul>
<li>Golden plan corpus in <code>tests/fixtures/plans/</code>.</li>
<li><code>just plan-test</code> runs each adapter against domain/problem pairs and compares
to golden JSON using <code>serde_json::Value</code> diff.</li>
<li>Mutation tests via <code>mutagen</code> ensure parsing logic robust to format drift.</li>
</ul>
<hr />
<h2 id="7-roadmap"><a class="header" href="#7-roadmap">7 Roadmap</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Version</th><th>Item</th></tr></thead><tbody>
<tr><td>0.5</td><td>Fast Downward adapter + auto PDDL generation</td></tr>
<tr><td>0.8</td><td>OPTIC temporal support</td></tr>
<tr><td>1.2</td><td>JSHOP‑2 HTN adapter</td></tr>
<tr><td>1.2</td><td>RL<em>Critic integration (choose best of_N</em> plans)</td></tr>
<tr><td>2.0</td><td>Prost RDDL adapter for stochastic environments</td></tr>
</tbody></table>
</div>
<hr />
<h2 id="8-faq"><a class="header" href="#8-faq">8 FAQ</a></h2>
<p><strong>Why two adapters instead of flags?</strong><br />
Different output formats and search flags; easier to encapsulate.</p>
<p><strong>Does it work without Python?</strong><br />
Binaries are vendored via Cargo build‑script if host lacks Python.</p>
<p><strong>Can I visualise the plan?</strong><br />
Yes—Planner View in UI renders a Gantt when temporal data present.</p>
<hr />
<p>See also:</p>
<ul>
<li><a href="components/../architecture/planner-integration.html">Planner Integration</a></li>
<li><a href="components/../ai-sub-system-docs/rl-critic.html">RL Critic</a></li>
<li><a href="components/../component-details/orchestrator.html">Orchestrator</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><blockquote>
<p><em>Status: Draft — last updated 2025‑06‑20</em></p>
</blockquote>
<h1 id="wasi-plugin-host"><a class="header" href="#wasi-plugin-host">WASI Plugin Host</a></h1>
<h2 id="responsibilities-2"><a class="header" href="#responsibilities-2">Responsibilities</a></h2>
<ul>
<li>Host and manage WASI plugins</li>
<li>Enforce capability tokens and sandboxing</li>
<li>Provide host functions for plugin interaction</li>
<li>Verify plugin signatures (Ed25519)</li>
<li>Enforce per-plugin permissions (filesystem/network)</li>
</ul>
<h2 id="public-apis-2"><a class="header" href="#public-apis-2">Public APIs</a></h2>
<ul>
<li><code>load_plugin(path: str)</code></li>
<li><code>call_plugin(func: str, args: List)</code></li>
</ul>
<h2 id="extension-hooks-2"><a class="header" href="#extension-hooks-2">Extension Hooks</a></h2>
<ul>
<li>Support for new plugin types (REST, gRPC, future adapters)</li>
<li>Custom host functions</li>
</ul>
<h2 id="roadmap--enhancements-2"><a class="header" href="#roadmap--enhancements-2">Roadmap &amp; Enhancements</a></h2>
<ul>
<li>OCI-based plugin registry</li>
<li>In-app plugin discovery UI</li>
<li>Security templates &amp; SDKs for plugin authoring</li>
<li>Sample plugins with docs and best practices</li>
<li>Registry/discovery UI for plugin management</li>
</ul>
<h2 id="open-questions-2"><a class="header" href="#open-questions-2">Open Questions</a></h2>
<ul>
<li>How to manage plugin permissions securely?</li>
<li>What is the best way to version plugins?</li>
<li>How to support new plugin transports (GraphRAG, telemetry)?</li>
</ul>
<h2 id="how-to-extendcustomize-2"><a class="header" href="#how-to-extendcustomize-2">How to Extend/Customize</a></h2>
<ul>
<li>Add new host functions via the plugin API</li>
<li>Register new plugin types in the registry</li>
<li>Configure plugin permissions in the config file</li>
</ul>
<h2 id="real-world-usage-example-2"><a class="header" href="#real-world-usage-example-2">Real-World Usage Example</a></h2>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>plugin_host.load_plugin("my_plugin.wasm");
<span class="boring">}</span></code></pre></pre>
<hr />
<ul>
<li>Plugins are auto-discovered from <code>~/.local/share/stack-composer/plugins/</code>.</li>
<li>Only plugins with valid Ed25519 signatures are loaded (see <a href="components/../plugin-sdk/README.html">Plugin SDK</a>).</li>
<li>Per-plugin permissions (filesystem/network) are enforced as configured (see <a href="components/../configuration.html">Configuration Guide</a>).</li>
</ul>
<p>See <a href="components/../architecture/architecture-questions.html">architecture-questions.md</a> for open questions and strategic direction.</p>
<p><em>See also: <a href="components/llm-runtime.html">LLM Runtime</a>, <a href="components/telemetry.html">Telemetry Pipeline</a></em></p>
<hr />
<p>The <strong>Plugin Host</strong> lets Stack Composer load, execute and sandbox untrusted
extensions compiled to WebAssembly System Interface (<strong>WASI</strong>). It provides an
API surface that mirrors native host functions (retrieval, LLM, planner, log,
network) while enforcing capability‑based security and signature verification.</p>
<hr />
<h2 id="1-responsibilities-6"><a class="header" href="#1-responsibilities-6">1 Responsibilities</a></h2>
<div class="table-wrapper"><table><thead><tr><th>#</th><th>Task</th><th>Implementation</th></tr></thead><tbody>
<tr><td>1</td><td>Discover plugins in user + system dirs</td><td><code>~/.local/share/stack-composer/plugins/</code> and <code>/opt/stack-composer/plugins/</code></td></tr>
<tr><td>2</td><td>Verify <strong>Ed25519</strong> signatures</td><td><code>ed25519-dalek</code> crate; trust store in <code>trusted_keys.toml</code></td></tr>
<tr><td>3</td><td>Instantiate Wasm via <strong>Wasmtime</strong></td><td>WasiCtx builder restricts FS &amp; net according to capability token</td></tr>
<tr><td>4</td><td>Expose host functions</td><td><code>retrieval_search</code>, <code>llm_chat</code>, <code>plan_solve</code>, <code>log</code>, <code>network_fetch*</code></td></tr>
<tr><td>5</td><td>Enforce per‑plugin runtime limits</td><td>Fuel metering (10 M ops), 256 MiB mem cap, 5 s wall‑time</td></tr>
<tr><td>6</td><td>Hot‑reload on file change</td><td>Notify watcher ⇒ unload → verify → reload</td></tr>
<tr><td>7</td><td>Telemetry &amp; audit</td><td>Emit <code>plugin.load</code>, <code>plugin.call</code>, <code>plugin.panic</code> OTLP spans</td></tr>
</tbody></table>
</div>
<hr />
<h2 id="2-directory-layout--discovery"><a class="header" href="#2-directory-layout--discovery">2 Directory Layout &amp; Discovery</a></h2>
<pre><code class="language-text">plugins/
├─ hello-plugin.wasm
├─ hello-plugin.sig
├─ hello-plugin.toml
└─ readme.md
</code></pre>
<ul>
<li><code>.wasm</code> – compiled WASI module</li>
<li><code>.sig</code> – Ed25519 signature file (hex)</li>
<li><code>.toml</code> – manifest (see § 3)</li>
<li>Extra docs are ignored at runtime but shown in Marketplace UI.</li>
</ul>
<hr />
<h2 id="3-plugin-manifest-schema-plugintoml"><a class="header" href="#3-plugin-manifest-schema-plugintoml">3 Plugin Manifest Schema (<code>plugin.toml</code>)</a></h2>
<pre><code class="language-toml">[plugin]
id          = "org.example.hello"
version     = "0.1.0"
wasm_target = "wasm32-wasi"
signature   = "file:hello-plugin.sig"
capabilities = ["log", "retrieval"]
entry       = "_start"

[meta]
name        = "Hello Plugin"
description = "Echo back the user input."
license     = "MIT"
authors     = ["Jane Dev &lt;jane@example.org&gt;"]
</code></pre>
<hr />
<h2 id="4-capability-model"><a class="header" href="#4-capability-model">4 Capability Model</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Capability</th><th>Host Function(s)</th><th>Notes</th></tr></thead><tbody>
<tr><td><code>log</code></td><td><code>host_log(level: i32, ptr: *, len: usize)</code></td><td>Always enabled</td></tr>
<tr><td><code>retrieval</code></td><td><code>host_retrieval_search(q_ptr, q_len, k)</code></td><td>RAG chunks returned</td></tr>
<tr><td><code>llm</code></td><td><code>host_llm_chat(req_ptr, len)</code></td><td>Stream tokens</td></tr>
<tr><td><code>plan</code></td><td><code>host_plan(domain_ptr, prob_ptr)</code></td><td>Planner JSON</td></tr>
<tr><td><code>network</code></td><td><code>host_fetch(url_ptr, len, body_ptr, body_len)</code></td><td>Disabled offline</td></tr>
<tr><td><code>fs_read</code></td><td>WASI <code>path_open</code> read‑only</td><td>Sandboxed dir <code>/plugin/data</code></td></tr>
</tbody></table>
</div>
<p>Plugins request caps in manifest; orchestrator grants or denies. Denied caps
result in trap on call.</p>
<hr />
<h2 id="5-runtime-flow"><a class="header" href="#5-runtime-flow">5 Runtime Flow</a></h2>
<pre><code class="language-mermaid">sequenceDiagram
  participant Host
  participant Wasm
  Host-&gt;&gt;Wasm: instantiate(module, CapToken)
  Wasm--&gt;&gt;Host: _start()
  Wasm-&gt;&gt;Host: host_retrieval_search("react", 10)
  Host--&gt;&gt;Wasm: ChunkVec
  Wasm--&gt;&gt;Host: result ptr
</code></pre>
<p>Fuel metering decrements per Wasm op; exhaustion traps with
<code>PluginError::FuelExhausted</code>.</p>
<hr />
<h2 id="6-security--sandboxing-1"><a class="header" href="#6-security--sandboxing-1">6 Security &amp; Sandboxing</a></h2>
<ul>
<li><strong>Wasmtime 18</strong> with <code>Config::new().consume_fuel(true)</code></li>
<li>Memory cap 256 MiB (<code>StoreLimiterAsync</code>).</li>
<li>No <code>fd_write</code> unless <code>log</code> cap is granted.</li>
<li><code>network</code> cap subject to proxy &amp; offline mode.</li>
<li>SHA‑256 hash of <code>.wasm</code> and <code>.sig</code> logged for SBOM.</li>
</ul>
<hr />
<h2 id="7-public-host-apis-wit--v1"><a class="header" href="#7-public-host-apis-wit--v1">7 Public Host APIs (WIT ≥ v1)</a></h2>
<pre><code class="language-wit">package stack-composer:plugin;

interface host {
  log: func(level: s32, msg: string);
  retrieval-search: func(query: string, k: u32) -&gt; list&lt;chunk&gt;;
  llm-chat: func(request: chat-request) -&gt; stream&lt;token-delta&gt;;
  plan-solve: func(domain: string, problem: string) -&gt; list&lt;plan-step&gt;;
  network-fetch: func(url: string, body: option&lt;string&gt;) -&gt; string;
}
</code></pre>
<p>Generated bindings via <code>wit-bindgen</code> for Rust, TinyGo, Zig, JS.</p>
<hr />
<h2 id="8-configuration-plugin-hosttoml"><a class="header" href="#8-configuration-plugin-hosttoml">8 Configuration (<code>plugin-host.toml</code>)</a></h2>
<pre><code class="language-toml">[limits]
fuel_units   = 10000000
mem_bytes    = 268435456
wall_timeout_ms = 5000

[paths]
user_dir  = "~/.local/share/stack-composer/plugins"
system_dir = "/opt/stack-composer/plugins"
</code></pre>
<hr />
<h2 id="9-marketplace-workflow"><a class="header" href="#9-marketplace-workflow">9 Marketplace Workflow</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Phase</th><th>Detail</th><th>Version</th></tr></thead><tbody>
<tr><td>Discovery</td><td>Scan directories, parse manifests</td><td>0.5</td></tr>
<tr><td>Rating</td><td>User can star/rate; data stored locally</td><td>0.8</td></tr>
<tr><td>Registry</td><td>OCI registry backend (<code>crates/registry</code>)</td><td>0.8</td></tr>
<tr><td>Auto‑update</td><td>Check new version → verify sig → hot‑swap</td><td>1.1</td></tr>
</tbody></table>
</div>
<hr />
<h2 id="10-testing"><a class="header" href="#10-testing">10 Testing</a></h2>
<ul>
<li>Unit tests use <code>wasmtime::Module::new(&amp;engine, wasm_bytes)</code> fixtures.</li>
<li>Integration tests load sample plugin and assert host func round‑trips.</li>
<li>Fuzzing (<code>cargo fuzz</code>) targets signature parser &amp; capability deserializer.</li>
</ul>
<hr />
<h2 id="11-open-questions"><a class="header" href="#11-open-questions">11 Open Questions</a></h2>
<ol>
<li>Support WASI‑NN interface for on‑device model inference?</li>
<li>Version negotiation for host functions beyond v1?</li>
<li>Should plugin logs pipe to centralized UI pane?</li>
</ol>
<hr />
<h2 id="12-usage-snippet"><a class="header" href="#12-usage-snippet">12 Usage Snippet</a></h2>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>let ph = PluginHost::default();
ph.load_plugin("/path/to/hello-plugin.wasm").await?;
let res = ph.call_plugin("run", &amp;["hello"]).await?;
println!("Plugin said: {}", res);
<span class="boring">}</span></code></pre></pre>
<hr />
<h2 id="see-also"><a class="header" href="#see-also">See Also</a></h2>
<ul>
<li><a href="components/../architecture/component-details/plugin-example.html">Plugin Example</a>: Concrete WASI plugin/extension example for Stack Composer extensibility.</li>
</ul>
<p>See also:</p>
<ul>
<li><a href="components/../plugin-sdk/README.html">Plugin SDK</a></li>
<li><a href="components/llm-runtime.html">LLM Runtime</a></li>
<li><a href="components/telemetry.html">Telemetry Pipeline</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="report-agent"><a class="header" href="#report-agent">Report Agent</a></h1>
<p><em>Status: Draft — last updated 2025-06-20</em><br />
The <strong>Report Agent</strong> (RA) is the final step in Stack Composer’s pipeline.<br />
It collates the selected tech‑stack proposal, plan timelines, evidence
citations, and expert rationale into both human‑friendly and machine‑readable
artefacts. It can also scaffold a starter repository complete with CI, Docker,
and documentation.</p>
<hr />
<h2 id="1-responsibilities-7"><a class="header" href="#1-responsibilities-7">1 Responsibilities</a></h2>
<div class="table-wrapper"><table><thead><tr><th>#</th><th>Responsibility</th><th>Detail</th></tr></thead><tbody>
<tr><td>1</td><td><strong>Render human report</strong></td><td>Markdown (UI preview), optional PDF/DOCX export</td></tr>
<tr><td>2</td><td><strong>Emit machine spec</strong></td><td>JSON (versioned schema) consumed by CI/CD</td></tr>
<tr><td>3</td><td><strong>Generate scaffold</strong></td><td>Directory tree, <code>README</code>, <code>Dockerfile</code>, workflows</td></tr>
<tr><td>4</td><td><strong>Citations &amp; traceability</strong></td><td>Inline ⧉ links resolve back to RAG chunks</td></tr>
<tr><td>5</td><td><strong>Export via adapters</strong></td><td>GitHub push, Zip archive, DevContainer</td></tr>
<tr><td>6</td><td><strong>Post‑generation hooks</strong></td><td>Invoke user scripts / plugins after export</td></tr>
</tbody></table>
</div>
<hr />
<h2 id="2-data-flow-2"><a class="header" href="#2-data-flow-2">2 Data Flow</a></h2>
<pre><code class="language-mermaid">flowchart LR
  Proposal[Chosen Tech‑Stack Proposal] --&gt; R[Report Agent]
  Plan[Planner JSON] --&gt; R
  Evidence[RAG Chunks + Citations] --&gt; R
  R --&gt; M[Markdown Report]
  R --&gt; J[JSON Spec]
  R --&gt; S[Repo Scaffold]
  R --&gt; E[Export Adapters]
</code></pre>
<hr />
<h2 id="3-public-api"><a class="header" href="#3-public-api">3 Public API</a></h2>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>pub struct ReportRequest {
    pub proposal: Proposal,
    pub plan: Vec&lt;PlanStep&gt;,
}

pub struct ReportArtifacts {
    pub markdown_path: PathBuf,
    pub json_path: PathBuf,
    pub scaffold_dir: Option&lt;PathBuf&gt;,
}

#[async_trait]
pub trait ReportAgent {
    async fn generate(req: ReportRequest) -&gt; anyhow::Result&lt;ReportArtifacts&gt;;
    async fn export(art: &amp;ReportArtifacts, target: ExportTarget) -&gt; anyhow::Result&lt;()&gt;;
}
<span class="boring">}</span></code></pre></pre>
<p><em><code>ExportTarget</code> = <code>GitHubRepo { token, repo } | Zip | FileSystem(PathBuf)</code>.</em></p>
<hr />
<h2 id="4-report-template-v0-5"><a class="header" href="#4-report-template-v0-5">4 Report Template (v0 .5)</a></h2>
<ol>
<li><strong>Executive Summary</strong> – 1‑paragraph tl;dr</li>
<li><strong>Stack Radar</strong> – SVG radar chart of language, framework, infra scores</li>
<li><strong>Plan Timeline</strong> – Table + optional Gantt (if temporal plan)</li>
<li><strong>Licence &amp; Security Matrix</strong> – SPDX id, CVSS scores</li>
<li><strong>Scaffold Overview</strong> – Tree view snippet</li>
<li><strong>Rationale &amp; Citations</strong> – Collapsible sections with ⧉ links</li>
</ol>
<p>Templates stored in <code>templates/report_v05/*.tera</code> (Tera syntax).</p>
<hr />
<h2 id="5-scaffold-generator"><a class="header" href="#5-scaffold-generator">5 Scaffold Generator</a></h2>
<ul>
<li><strong>Directory renderer</strong> – uses <code>liquid</code> templates so plugin can override.</li>
<li>Default scaffold structure:</li>
</ul>
<pre><code class="language-text">scaffold/
├─ README.md
├─ docker/
│  └─ Dockerfile
├─ .github/workflows/
│  └─ ci.yml
└─ src/
</code></pre>
<ul>
<li>Permissions: <code>chmod +x scripts/*.sh</code> during generation.</li>
<li>CI workflow uses Node or Rust template based on stack choice.</li>
</ul>
<hr />
<h2 id="6-export-adapters"><a class="header" href="#6-export-adapters">6 Export Adapters</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Adapter</th><th>Capabilities</th></tr></thead><tbody>
<tr><td><strong>GitHubPush</strong></td><td>Create repo, push scaffold, open PR with report</td></tr>
<tr><td><strong>ZipArchive</strong></td><td>Compress scaffold + report; downloads via UI</td></tr>
<tr><td><strong>DevContainer</strong></td><td>Emits <code>.devcontainer/devcontainer.json</code></td></tr>
</tbody></table>
</div>
<p>Adapters register via WASI plugin: <code>export(target, artifacts) -&gt; Result</code>.</p>
<hr />
<h2 id="7-configuration-reporttoml"><a class="header" href="#7-configuration-reporttoml">7 Configuration (<code>report.toml</code>)</a></h2>
<pre><code class="language-toml">[report]
default_format = "markdown"
include_citations = true
scaffold = true

[export]
default_target = "zip"
github_org = "my-org"
</code></pre>
<hr />
<h2 id="8-uiux-integration-1"><a class="header" href="#8-uiux-integration-1">8 UI/UX Integration</a></h2>
<ul>
<li>Wizard final screen shows <strong>Preview</strong> tabs (Report · JSON · Scaffold).</li>
<li><strong>Download</strong> dropdown picks format/target.</li>
<li>“Push to GitHub” button asks for PAT; stored in OS keychain.</li>
</ul>
<hr />
<h2 id="9-security"><a class="header" href="#9-security">9 Security</a></h2>
<ul>
<li>Sanitises any Markdown to avoid XSS in webview.</li>
<li>GitHub token stored using <code>keyring</code> crate; never written to disk.</li>
<li>Scaffold repo uses Apache‑2.0 licence file by default.</li>
</ul>
<hr />
<h2 id="10-roadmap"><a class="header" href="#10-roadmap">10 Roadmap</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Version</th><th>Feature</th></tr></thead><tbody>
<tr><td>0.5</td><td>Markdown + JSON + Zip export (this spec)</td></tr>
<tr><td>0.8</td><td>GitHubPush adapter, PDF (wkhtmltopdf)</td></tr>
<tr><td>1.0</td><td>Confluence / Jira connectors</td></tr>
<tr><td>1.1</td><td>Custom template marketplace</td></tr>
<tr><td>2.0</td><td>Multilingual report rendering</td></tr>
</tbody></table>
</div>
<hr />
<h2 id="11-open-questions-1"><a class="header" href="#11-open-questions-1">11 Open Questions</a></h2>
<ul>
<li>Which PDF engine gives best accessibility tags?</li>
<li>How to diff scaffold updates on re‑generation?</li>
<li>Should export adapters be allowed network in offline mode?</li>
</ul>
<hr />
<h2 id="12-usage-example"><a class="header" href="#12-usage-example">12 Usage Example</a></h2>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>let req = ReportRequest { proposal, plan };
let artifacts = report_agent.generate(req).await?;
report_agent.export(&amp;artifacts, ExportTarget::Zip)?;
<span class="boring">}</span></code></pre></pre>
<hr />
<p>See also:</p>
<ul>
<li><a href="components/stack-agent.html">Stack Agent</a></li>
<li><a href="components/planner-adapter.html">Planner Adapter</a></li>
<li><a href="components/../plugin-sdk/README.html">Plugin SDK</a></li>
</ul>
<pre><code class="language-text">
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="retrieval-layer-hybrid-dense--sparse-search"><a class="header" href="#retrieval-layer-hybrid-dense--sparse-search">Retrieval Layer (Hybrid Dense + Sparse Search)</a></h1>
<blockquote>
<p><em>Status: Draft — last updated 2025‑06‑20</em></p>
</blockquote>
<p>The <strong>Retrieval Layer</strong> powers Stack Composer’s hybrid search.
It combines <strong>Qdrant</strong> (dense vectors) and <strong>Meilisearch 1.6</strong> (BM25 sparse
index) behind a single Rust crate so every agent—Ingestion, Gap, Stack,
Report—can issue one query and receive a ranked, licence‑aware result set.</p>
<hr />
<h2 id="1-responsibilities-8"><a class="header" href="#1-responsibilities-8">1 Responsibilities</a></h2>
<div class="table-wrapper"><table><thead><tr><th>#</th><th>Responsibility</th><th>Detail</th></tr></thead><tbody>
<tr><td>1</td><td><strong>Store</strong> embedded vectors &amp; text payloads</td><td>Qdrant HNSW index; Meilisearch primary index</td></tr>
<tr><td>2</td><td><strong>Serve hybrid queries</strong></td><td>Reciprocal‑rank fusion (RRF) merges dense &amp; sparse k‑lists</td></tr>
<tr><td>3</td><td><strong>Licence filtering</strong></td><td>Discard non‑OSI SPDX IDs when requested</td></tr>
<tr><td>4</td><td><strong>Domain boosts</strong></td><td>Ontology tags adjust scores (e.g., boost Rust when <code>lang = rust</code>)</td></tr>
<tr><td>5</td><td><strong>Transactional writes</strong></td><td>Inserts/updates land in both stores or roll back</td></tr>
<tr><td>6</td><td><strong>Extensibility hooks</strong></td><td>Plug‑in alternative DBs or ranking strategies</td></tr>
</tbody></table>
</div>
<hr />
<h2 id="2-architecture-diagram"><a class="header" href="#2-architecture-diagram">2 Architecture Diagram</a></h2>
<pre><code class="language-mermaid">flowchart LR
  subgraph Retrieval-Layer
    A(Embedder&lt;br/&gt;1536‑dim) --&gt; Q[Qdrant&lt;br/&gt;HNSW]
    A --&gt; M[Meilisearch&lt;br/&gt;BM25+vector]
    Q ==&gt;|dense k=128| F[Reciprocal‑Rank&lt;br/&gt;Fusion]
    M ==&gt;|sparse k=256| F
    F --&gt;|top‑N| Agents
  end
</code></pre>
<ul>
<li><strong>Qdrant</strong> runs in embedded mode, eliminating external services.</li>
<li><strong>Meilisearch 1.6</strong> now supports hybrid score weighing; we keep a text copy for
wildcard licence/keyword filters.</li>
<li><strong>RRF λ = 0.5</strong>, k<sub>D</sub>=128, k<sub>S</sub>=256 by default.</li>
</ul>
<hr />
<h2 id="3-data-model"><a class="header" href="#3-data-model">3 Data Model</a></h2>
<h3 id="31-qdrant-payload"><a class="header" href="#31-qdrant-payload">3.1 Qdrant payload</a></h3>
<pre><code class="language-jsonc">{
  "id": "uuid-v4",
  "text": "…chunk…",
  "source": "file:///brief.md#L55-L78",
  "spdx": "MIT",
  "tags": ["rust", "web"],
  "ingested_at": "2025-06-20T09:38:00Z",
}
</code></pre>
<h3 id="32-meilisearch-schema"><a class="header" href="#32-meilisearch-schema">3.2 Meilisearch schema</a></h3>
<div class="table-wrapper"><table><thead><tr><th>Field</th><th>Type</th><th>Indexed</th><th>Filterable</th></tr></thead><tbody>
<tr><td><code>id</code></td><td>string</td><td>✔</td><td>✔</td></tr>
<tr><td><code>text</code></td><td>string</td><td>✔</td><td>—</td></tr>
<tr><td><code>spdx</code></td><td>string</td><td>✔</td><td>✔</td></tr>
<tr><td><code>tags</code></td><td>string[]</td><td>✔</td><td>✔</td></tr>
<tr><td><code>vector</code></td><td>float[1536]</td><td>✔ (hybrid)</td><td>—</td></tr>
</tbody></table>
</div>
<hr />
<h2 id="4-public-rust-api"><a class="header" href="#4-public-rust-api">4 Public Rust API</a></h2>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>pub struct HybridConfig {
    pub k_dense: usize,
    pub k_sparse: usize,
    pub lambda: f32, // fusion weight
}

#[async_trait]
pub trait RetrievalLayer: Send + Sync {
    async fn search(&amp;self, query: &amp;str, cfg: Option&lt;HybridConfig&gt;)
        -&gt; anyhow::Result&lt;Vec&lt;ScoredChunk&gt;&gt;;

    async fn index(&amp;self, doc: Document) -&gt; anyhow::Result&lt;()&gt;;

    async fn flush(&amp;self) -&gt; anyhow::Result&lt;()&gt;;
}
<span class="boring">}</span></code></pre></pre>
<p><code>ScoredChunk</code> includes <code>score</code>, <code>text</code>, <code>source</code>, <code>spdx</code>.</p>
<hr />
<h2 id="5-configuration-retrievaltoml"><a class="header" href="#5-configuration-retrievaltoml">5 Configuration (<code>retrieval.toml</code>)</a></h2>
<pre><code class="language-toml">[qdrant]
path          = "~/.local/share/stack-composer/qdrant"
wal_capacity  = 104857600   # 100 MB

[meili]
addr          = "http://127.0.0.1:7700"
key           = "masterKey"
index_name    = "chunks"

[hybrid]
k_dense       = 128
k_sparse      = 256
lambda        = 0.5
licence_mode  = "permissive_only"  # or "all"

[boosts]
rust          = 1.3
python        = 1.1
</code></pre>
<p>Hot‑reload supported—changes apply next query.</p>
<hr />
<h2 id="6-extensibility-hooks"><a class="header" href="#6-extensibility-hooks">6 Extensibility Hooks</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Hook</th><th>Description</th></tr></thead><tbody>
<tr><td><strong>Custom Ranker</strong></td><td>WASI plugin supplies <code>fn fuse(dense, sparse) -&gt; Vec&lt;Scored&gt;</code></td></tr>
<tr><td><strong>Alt Vector DB</strong></td><td>Implement <code>VectorStore</code> trait; register with builder</td></tr>
<tr><td><strong>GraphRAG</strong></td><td>v 2.0 plugin can bypass hybrid and walk property graph</td></tr>
</tbody></table>
</div>
<hr />
<h2 id="7-security--privacy"><a class="header" href="#7-security--privacy">7 Security &amp; Privacy</a></h2>
<ul>
<li>All data kept local unless crawler pulls remote feeds.</li>
<li>SDL scan removes emails/IPs before chunk insert if “PII scrub” enabled.</li>
<li>Meili master‑key stored in OS keychain; HTTP interface bound to localhost.</li>
</ul>
<hr />
<h2 id="8-performance-benchmarks"><a class="header" href="#8-performance-benchmarks">8 Performance Benchmarks</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Dataset</th><th>Chunks</th><th>p50 latency (ms)</th><th>p95</th><th>Memory</th></tr></thead><tbody>
<tr><td>Small (10 k)</td><td>10 000</td><td>23</td><td>45</td><td>120 MB</td></tr>
<tr><td>Medium (100 k)</td><td>100 000</td><td>87</td><td>140</td><td>480 MB</td></tr>
<tr><td>Large (1 M)</td><td>1 000 000</td><td>410</td><td>690</td><td>3.4 GB</td></tr>
</tbody></table>
</div>
<p>Bench harness in <code>benches/hybrid_bench.rs</code>.</p>
<hr />
<h2 id="9-roadmap-3"><a class="header" href="#9-roadmap-3">9 Roadmap</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Version</th><th>Feature</th></tr></thead><tbody>
<tr><td>0.5</td><td>Qdrant + Meili hybrid (this spec)</td></tr>
<tr><td>0.8</td><td>Cloud vector DB (Turso/Qdrant Cloud) toggle</td></tr>
<tr><td>1.0</td><td>GraphRAG plugin &amp; property‑graph queries</td></tr>
<tr><td>1.1</td><td>Zero‑copy mmap chunks for 10 M scale</td></tr>
<tr><td>2.0</td><td>Cross‑project federated retrieval</td></tr>
</tbody></table>
</div>
<hr />
<h2 id="10-open-questions-1"><a class="header" href="#10-open-questions-1">10 Open Questions</a></h2>
<ol>
<li>Strategy for chunk dedup across multiple briefs?</li>
<li>Heuristic for real‑time index flush vs. batch when &gt;1 M chunks?</li>
<li>Should citation confidence influence fusion weight dynamically?</li>
</ol>
<hr />
<h2 id="11-usage-example-1"><a class="header" href="#11-usage-example-1">11 Usage Example</a></h2>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>let cfg = HybridConfig { k_dense: 64, k_sparse: 128, lambda: 0.6 };
let hits = retrieval_layer.search("low‑latency Rust web server", Some(cfg)).await?;
for h in hits.iter().take(3) {
    println!("{} (score {:.3}) — {}", h.spdx, h.score, h.source);
}
<span class="boring">}</span></code></pre></pre>
<hr />
<p>See also:</p>
<ul>
<li><a href="components/../ai-sub-system-docs/rag-design.html">RAG Design</a></li>
<li><a href="components/llm-runtime.html">LLM Runtime</a></li>
<li><a href="components/ingestion-agent.html">Ingestion Agent</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="telemetry-pipeline"><a class="header" href="#telemetry-pipeline">Telemetry Pipeline</a></h1>
<p><em>Status: Draft — last updated 2025-06-20</em><br />
The <strong>Telemetry Pipeline</strong> provides observability into Stack Composer while
respecting the project’s strict <strong>privacy-first</strong> stance. By default, all
metrics and traces are kept <strong>locally</strong> as JSON files and auto‑purged after
30 days. Users may opt‑in to upload anonymised bundles to a remote collector.</p>
<hr />
<h2 id="1-responsibilities-9"><a class="header" href="#1-responsibilities-9">1 Responsibilities</a></h2>
<div class="table-wrapper"><table><thead><tr><th>#</th><th>Responsibility</th><th>Detail</th></tr></thead><tbody>
<tr><td>1</td><td><strong>Collect spans &amp; metrics</strong></td><td>OpenTelemetry Rust SDK (v0.22)</td></tr>
<tr><td>2</td><td><strong>Write local trace bundles</strong></td><td>OTLP file exporter → <code>.jsonl</code></td></tr>
<tr><td>3</td><td><strong>Retention &amp; purge</strong></td><td>Cron deletes files &gt;30 days or on‑demand</td></tr>
<tr><td>4</td><td><strong>Manual upload</strong></td><td>Compress + POST to remote Jaeger/Tempo</td></tr>
<tr><td>5</td><td><strong>Privacy guardrails</strong></td><td>Hash project IDs; never log brief content</td></tr>
<tr><td>6</td><td><strong>Plugin hooks</strong></td><td>WASI plugins may record custom events via host fn</td></tr>
</tbody></table>
</div>
<hr />
<h2 id="2-architecture-diagram-1"><a class="header" href="#2-architecture-diagram-1">2 Architecture Diagram</a></h2>
<pre><code class="language-mermaid">flowchart LR
  subgraph Runtime
    A[Agent / Service] --&gt; M(otel::metric!)
    A --&gt; S(otel::span!)
  end
  M &amp; S --&gt; E[OTLP File Exporter&lt;br/&gt;JSONL]
  E --&gt;|flush| F[Local Trace Dir&lt;br/&gt;~/.local/share/stack-composer/telemetry]
  F --&gt;|opt‑in upload| U[Uploader&lt;br/&gt;HTTPS PUT]
  F --&gt;|purge 30 d| P[Purger]
</code></pre>
<hr />
<h2 id="3-data-model-1"><a class="header" href="#3-data-model-1">3 Data Model</a></h2>
<h3 id="31-metric-record"><a class="header" href="#31-metric-record">3.1 Metric Record</a></h3>
<pre><code class="language-jsonc">{
  "timestamp": "2025-06-20T12:00:01Z",
  "metric": "agent.latency_ms",
  "value": 123,
  "labels": { "agent": "stack", "phase": "score" },
}
</code></pre>
<h3 id="32-span-record"><a class="header" href="#32-span-record">3.2 Span Record</a></h3>
<pre><code class="language-jsonc">{
  "trace_id": "b17f…",
  "span_id": "9c2a…",
  "parent_id": null,
  "name": "retrieval.search",
  "start_ns": 282917333,
  "end_ns": 283020999,
  "attrs": { "k_dense": 128, "k_sparse": 256 },
}
</code></pre>
<p>Project identifiers are SHA‑256 hashed before writing.</p>
<hr />
<h2 id="4-public-api-1"><a class="header" href="#4-public-api-1">4 Public API</a></h2>
<pre><code class="language-rust ignore">use std::path::PathBuf;
use std::collections::HashMap;

pub type Labels = HashMap&lt;String, String&gt;;

pub enum TelemetryEvent {
    Metric { name: &amp;'static str, value: f64, labels: Labels },
    SpanStart { name: &amp;'static str },
    SpanEnd,
}

pub trait Telemetry {
    fn record_event(&amp;self, ev: TelemetryEvent);
    fn flush(&amp;self) -&gt; anyhow::Result&lt;PathBuf&gt;;  // returns path of flushed file
}</code></pre>
<p>A global <code>TELEMETRY</code> sink is set up during orchestrator bootstrap.</p>
<hr />
<h2 id="5-configuration-telemetrytoml"><a class="header" href="#5-configuration-telemetrytoml">5 Configuration (<code>telemetry.toml</code>)</a></h2>
<pre><code class="language-toml">[telemetry]
enabled = true
exporter = "file"          # file | stdout | otlp_http
local_retention_days = 30
upload_enabled = false

[upload]
endpoint = "https://jaeger.my-org.com/api/traces"
compression = "gzip"
</code></pre>
<p>Changes hot‑reload; disabling telemetry stops new writes but keeps files until purge.</p>
<hr />
<h2 id="6-security--privacy"><a class="header" href="#6-security--privacy">6 Security &amp; Privacy</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Concern</th><th>Mitigation</th></tr></thead><tbody>
<tr><td>PII leakage</td><td>Redact e‑mails, tokens via regex; hashes instead of raw IDs</td></tr>
<tr><td>Data at rest</td><td>File permissions <code>600</code>; optional AES‑256 via OS keychain (v1.0)</td></tr>
<tr><td>Network egress</td><td>Upload only if <code>upload_enabled = true</code>; proxy honours <code>HTTPS_PROXY</code></td></tr>
<tr><td>Plugin abuse</td><td>Plugins limited to <code>telemetry.log(level, msg)</code> unless <code>telemetry</code> cap present</td></tr>
</tbody></table>
</div>
<p>GDPR toggle (<code>--gdpr</code>) disables telemetry entirely and purges traces after each stack generation.</p>
<hr />
<h2 id="7-dashboards"><a class="header" href="#7-dashboards">7 Dashboards</a></h2>
<ul>
<li><strong>Grafana</strong> datasource preset JSON under <code>dashboards/telemetry_grafana.json</code>
<ul>
<li>Panels: agent latency p95, retrieval qps, planner success %, critic value heatmap.</li>
</ul>
</li>
<li><strong>CLI</strong>: <code>stack-composer stats --since 24h</code> prints key counters.</li>
</ul>
<hr />
<h2 id="8-extension-hooks-1"><a class="header" href="#8-extension-hooks-1">8 Extension Hooks</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Hook</th><th>Description</th></tr></thead><tbody>
<tr><td><strong>New exporter</strong></td><td>WASI plugin implements <code>export(path) -&gt; Result</code></td></tr>
<tr><td><strong>Custom event</strong></td><td>Plugin calls <code>host_telemetry_event(json_ptr, len)</code></td></tr>
<tr><td><strong>Real‑time push</strong></td><td>gRPC streaming exporter planned v1.1</td></tr>
</tbody></table>
</div>
<hr />
<h2 id="9-roadmap-4"><a class="header" href="#9-roadmap-4">9 Roadmap</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Version</th><th>Feature</th></tr></thead><tbody>
<tr><td>0.5</td><td>File exporter, manual upload, purge UI</td></tr>
<tr><td>0.8</td><td>Prometheus exporter for live Grafana</td></tr>
<tr><td>1.0</td><td>Encrypted trace store (sqlcipher)</td></tr>
<tr><td>1.1</td><td>gRPC streaming to Tempo, alert hooks</td></tr>
<tr><td>2.0</td><td>Differential‑privacy metrics aggregation</td></tr>
</tbody></table>
</div>
<hr />
<h2 id="10-usage-examples"><a class="header" href="#10-usage-examples">10 Usage Examples</a></h2>
<h3 id="101-record-span"><a class="header" href="#101-record-span">10.1 Record Span</a></h3>
<pre><code class="language-rust ignore">let _span = telemetry::span!("planner.solve");
planner.solve().await?;</code></pre>
<h3 id="102-manual-upload"><a class="header" href="#102-manual-upload">10.2 Manual Upload</a></h3>
<pre><code class="language-bash">stack-composer telemetry upload --since 7d
</code></pre>
<h3 id="103-purge-now"><a class="header" href="#103-purge-now">10.3 Purge Now</a></h3>
<pre><code class="language-bash">stack-composer telemetry purge
</code></pre>
<hr />
<h2 id="11-open-questions-2"><a class="header" href="#11-open-questions-2">11 Open Questions</a></h2>
<ul>
<li>Should per‑user metrics be aggregated before upload for extra anonymity?</li>
<li>Auto‑throttle file size when disk &lt; 1 GB?</li>
<li>Provide “share debug bundle” CLI for bug reports?</li>
</ul>
<hr />
<p>See also:</p>
<ul>
<li><a href="components/plugin-host.html">Plugin Host</a></li>
<li><a href="components/../operations/ops-guide.html">Ops Guide</a></li>
<li><a href="components/orchestrator.html">Orchestrator</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="operational-docs"><a class="header" href="#operational-docs">Operational Docs</a></h1>
<ul>
<li><a href="operations/../operations/ops-guide.html">Ops Guide</a></li>
<li><a href="operations/../operations/security-policy.html">Security Policy</a></li>
<li><a href="operations/../operations/telemetry-privacy.html">Telemetry &amp; Privacy</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="operations-guide"><a class="header" href="#operations-guide">Operations Guide</a></h1>
<p>For reproducible local operations, see <a href="operations/../toolchain.html">Toolchain &amp; DX Pipeline</a> and <a href="operations/../../developer-extensibility-docs/dev-setup.html">Developer Setup</a> for Docker, Nix, and all required tools.</p>
<ul>
<li>Qdrant runs via Docker for local development.</li>
<li>Use <code>trivy</code> for container and SBOM health/security checks.</li>
<li>Nix enables reproducible ops environments.</li>
</ul>
<hr />
<h2 id="local-deployment-docker-compose-example"><a class="header" href="#local-deployment-docker-compose-example">Local Deployment: Docker Compose Example</a></h2>
<pre><code class="language-yaml">version: '3.8'
services:
  qdrant:
    image: qdrant/qdrant:v1.4
    ports: ['6333:6333']
    volumes:
      - qdrant_data:/qdrant/storage
  meilisearch:
    image: getmeili/meilisearch:v1.5
    ports: ['7700:7700']
    environment:
      - MEILI_NO_ANALYTICS=true
  stack-composer:
    build: .
    depends_on:
      - qdrant
      - meilisearch
    environment:
      - QDRANT_URL=http://qdrant:6333
      - MEILI_URL=http://meilisearch:7700
volumes:
  qdrant_data:
</code></pre>
<hr />
<h2 id="production-kubernetes-snippet"><a class="header" href="#production-kubernetes-snippet">Production: Kubernetes Snippet</a></h2>
<pre><code class="language-yaml">apiVersion: apps/v1
kind: Deployment
metadata:
  name: stack-composer
spec:
  replicas: 2
  selector:
    matchLabels:
      app: stack-composer
  template:
    metadata:
      labels:
        app: stack-composer
    spec:
      containers:
        - name: stack-composer
          image: ghcr.io/your-org/stack-composer:latest
          ports:
            - containerPort: 8080
          readinessProbe:
            httpGet:
              path: /healthz
              port: 8080
            initialDelaySeconds: 5
            periodSeconds: 10
          livenessProbe:
            httpGet:
              path: /livez
              port: 8080
            initialDelaySeconds: 10
            periodSeconds: 30
</code></pre>
<hr />
<h2 id="health--metrics-endpoints"><a class="header" href="#health--metrics-endpoints">Health &amp; Metrics Endpoints</a></h2>
<ul>
<li><code>/healthz</code> – Readiness probe (returns 200 if ready)</li>
<li><code>/livez</code> – Liveness probe (returns 200 if alive)</li>
<li><code>/metrics</code> – Prometheus metrics endpoint</li>
</ul>
<hr />
<h2 id="observability-stack-1"><a class="header" href="#observability-stack-1">Observability Stack</a></h2>
<ul>
<li><strong>Prometheus</strong>: Scrapes <code>/metrics</code> for system and app metrics.</li>
<li><strong>Grafana</strong>: Dashboards for latency, throughput, error rates.</li>
<li><strong>Jaeger</strong>: Distributed tracing via OpenTelemetry.</li>
<li><strong>ELK/OpenSearch</strong>: Structured log aggregation and search.</li>
<li><strong>Alerting</strong>: Example Prometheus rule:</li>
</ul>
<pre><code class="language-yaml">- alert: HighPlanLatency
  expr: plan_latency_seconds &gt; 5
  for: 5m
  labels:
    severity: warning
  annotations:
    summary: 'Plan latency is high (&gt;5s)'
</code></pre>
<hr />
<h2 id="topology-diagram"><a class="header" href="#topology-diagram">Topology Diagram</a></h2>
<pre><code class="language-mermaid">flowchart LR
    subgraph Cluster
        SC[Stack Composer]
        QD[Qdrant]
        ME[Meilisearch]
        PR[Prometheus]
        GR[Grafana]
        JG[Jaeger]
        LS[Logstash/ELK]
    end
    SC -- metrics --&gt; PR
    PR -- dashboards --&gt; GR
    SC -- traces --&gt; JG
    SC -- logs --&gt; LS
    SC -- hybrid search --&gt; QD
    SC -- hybrid search --&gt; ME
</code></pre>
<hr />
<h2 id="ontology-crawler--health-checks"><a class="header" href="#ontology-crawler--health-checks">Ontology Crawler &amp; Health Checks</a></h2>
<ul>
<li>Ontology crawler runs weekly to refresh the knowledge base.</li>
<li>Health checks: <code>/healthz</code>, <code>/livez</code>, and <code>/metrics</code> endpoints for monitoring and alerting.</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="security-policy"><a class="header" href="#security-policy">Security Policy</a></h1>
<p>Stack Composer follows modern security best practices. All contributors and users should:</p>
<ul>
<li>Review <a href="operations/../../developer-extensibility-docs/dev-setup.html">Developer Setup</a> for secure environment setup.</li>
<li>Use the latest toolchain as described in <a href="operations/../toolchain.html">Toolchain</a>.</li>
<li>Report vulnerabilities as described below.</li>
</ul>
<hr />
<h2 id="sbom--scanning"><a class="header" href="#sbom--scanning">SBOM &amp; Scanning</a></h2>
<ul>
<li>All releases include a CycloneDX SBOM (<code>bom.json</code>) published with release assets.</li>
<li>SBOM is updated automatically in CI using <code>trivy</code> and <code>cargo-audit</code>.</li>
<li>Scan containers and dependencies before each release.</li>
<li>All plugins are scanned with <code>trivy</code> and <code>cargo-audit</code> before release (see <a href="operations/../extensibility/plugin-sdk.html">Plugin SDK</a>).</li>
</ul>
<hr />
<h2 id="plugin-signing--verification"><a class="header" href="#plugin-signing--verification">Plugin Signing &amp; Verification</a></h2>
<ul>
<li>Every <code>.wasm</code> plugin must be accompanied by a <code>.sig</code> file (Ed25519 signature, hex).</li>
<li>Verification uses the <code>ed25519-dalek</code> crate; trusted public keys are listed in <code>~/.config/stack-composer/trusted_keys.toml</code>.</li>
<li>Plugins without valid signatures are rejected by default.</li>
<li>Security thresholds: CVSS ≥ 7.0 blocks plugin install; non-OSI/GPL licenses are blocked.</li>
</ul>
<hr />
<h2 id="telemetry--privacy"><a class="header" href="#telemetry--privacy">Telemetry &amp; Privacy</a></h2>
<ul>
<li>Telemetry is <strong>opt-in</strong> by default. Enable via config or CLI flag.</li>
<li>Collected fields: hashed project ID, feature flag counts, duration stats (no source text or PII).</li>
<li>Example log line:</li>
</ul>
<pre><code class="language-json">{
  "project_id": "abc123...",
  "feature_flags": { "planner": true },
  "duration_ms": 1234,
  "timestamp": "2025-06-20T12:34:56Z"
}
</code></pre>
<ul>
<li>Retention: Local JSON files are kept for 30 days unless manually purged.</li>
<li>Upload: Only on user action (GUI button or CLI flag).</li>
</ul>
<hr />
<h2 id="vulnerability-reporting"><a class="header" href="#vulnerability-reporting">Vulnerability Reporting</a></h2>
<ul>
<li>Please report security issues via GitHub Issues or the contact method in <a href="operations/../contributing/contributing.html">CONTRIBUTING.md</a>.</li>
<li>Triage: Acknowledge within 24h, assess CVSS, and prioritize patches.</li>
<li>Patch timeline: Critical issues patched within 7 days; others as scheduled.</li>
<li>Disclosure: Coordinated with reporter; public advisories for high/critical issues.</li>
</ul>
<hr />
<h2 id="gdpr--compliance"><a class="header" href="#gdpr--compliance">GDPR &amp; Compliance</a></h2>
<ul>
<li>No PII is collected by default; telemetry is anonymized and opt-in.</li>
<li>Data storage: All telemetry/logs are local unless user uploads.</li>
<li>Deletion: Users can purge all local data via GUI or CLI.</li>
<li>Compliance: GDPR mode disables telemetry and purges temp data after report generation.</li>
</ul>
<hr />
<h2 id="troubleshooting-1"><a class="header" href="#troubleshooting-1">Troubleshooting</a></h2>
<ul>
<li>For security-related setup issues, see <a href="operations/../../developer-extensibility-docs/dev-setup.html#troubleshooting">Developer Setup</a>.</li>
</ul>
<p><em>See also: <a href="operations/../extensibility/plugin-sdk.html">Plugin SDK</a>, <a href="operations/../configuration.html">Configuration Guide</a></em></p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="telemetry--privacy-1"><a class="header" href="#telemetry--privacy-1">Telemetry &amp; Privacy</a></h1>
<p>Stack Composer is designed with privacy in mind.</p>
<ul>
<li>See <a href="operations/../../developer-extensibility-docs/dev-setup.html">Developer Setup</a> for details on telemetry configuration.</li>
<li>The toolchain (<a href="operations/../toolchain.html">toolchain</a>) includes instructions for managing telemetry and privacy settings.</li>
<li>Local JSON flow and GDPR toggles are documented in the relevant sections.</li>
</ul>
<hr />
<h2 id="telemetry-schema"><a class="header" href="#telemetry-schema">Telemetry Schema</a></h2>
<ul>
<li><strong>Opt-in</strong> only: telemetry is disabled by default.</li>
<li>Collected fields: hashed project ID, feature flag counts, duration stats, timestamp.</li>
<li>No source text, PII, or user content is ever collected.</li>
</ul>
<h3 id="example-log-entry"><a class="header" href="#example-log-entry">Example Log Entry</a></h3>
<pre><code class="language-json">{
  "project_id": "abc123...",
  "feature_flags": { "planner": true },
  "duration_ms": 1234,
  "timestamp": "2025-06-20T12:34:56Z"
}
</code></pre>
<hr />
<h2 id="retention--upload"><a class="header" href="#retention--upload">Retention &amp; Upload</a></h2>
<ul>
<li>Local JSON files are retained for 30 days unless manually purged.</li>
<li>Upload is only triggered by explicit user action (GUI or CLI).</li>
</ul>
<hr />
<h2 id="gdpr--privacy-controls"><a class="header" href="#gdpr--privacy-controls">GDPR &amp; Privacy Controls</a></h2>
<ul>
<li>GDPR mode disables all telemetry and purges temp data after report generation.</li>
<li>Users can delete all local telemetry via GUI or CLI.</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="release-engineering"><a class="header" href="#release-engineering">Release Engineering</a></h1>
<ul>
<li><a href="release-engineering/../release-engineering/changelog.html">Changelog</a></li>
<li><a href="release-engineering/../release-engineering/release-process.html">Release Process</a></li>
<li><a href="release-engineering/../release-engineering/roadmap.html">Roadmap</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="changelog"><a class="header" href="#changelog">Changelog</a></h1>
<p>All notable changes to this project will be documented in this file.</p>
<p>The format is based on <a href="https://keepachangelog.com/en/1.0.0/">Keep a Changelog</a>, and this project adheres to <a href="https://semver.org/spec/v2.0.0.html">Semantic Versioning</a>.</p>
<h2 id="unreleased"><a class="header" href="#unreleased">[Unreleased]</a></h2>
<h3 id="added"><a class="header" href="#added">Added</a></h3>
<ul>
<li>Initial changelog structure and documentation updates.</li>
</ul>
<h3 id="changed"><a class="header" href="#changed">Changed</a></h3>
<ul>
<li>N/A</li>
</ul>
<h3 id="fixed"><a class="header" href="#fixed">Fixed</a></h3>
<ul>
<li>N/A</li>
</ul>
<h3 id="removed"><a class="header" href="#removed">Removed</a></h3>
<ul>
<li>N/A</li>
</ul>
<h2 id="v100---2025-06-20"><a class="header" href="#v100---2025-06-20">[v1.0.0] - 2025-06-20</a></h2>
<h3 id="initial-release"><a class="header" href="#initial-release">Initial Release</a></h3>
<ul>
<li>Initial public release of Stack Composer.</li>
<li>Core architecture, retrieval, planning, and plugin modules.</li>
<li>CI/CD pipeline, SBOM, and docs-as-code setup.</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="release-process"><a class="header" href="#release-process">Release Process</a></h1>
<p>This document describes the release process for Stack Composer.</p>
<h2 id="prerequisites"><a class="header" href="#prerequisites">Prerequisites</a></h2>
<ul>
<li>Ensure your environment is set up as described in <a href="release-engineering/../../developer-extensibility-docs/dev-setup.html">Developer Setup</a> and <a href="release-engineering/../toolchain.html">Toolchain</a>.</li>
<li>All releases must pass automated linting and tests (see <a href="release-engineering/../contributing/contributing.html">Contributing</a>).</li>
</ul>
<hr />
<h2 id="ci-build-matrix"><a class="header" href="#ci-build-matrix">CI Build Matrix</a></h2>
<ul>
<li>Supported platforms: Rust ≥1.70, Ubuntu 22.04, macOS 13+, Windows 11 (WSL2 supported)</li>
<li>Matrix includes: Rust stable/nightly, Docker build, UI test suite</li>
<li>Example (GitHub Actions):</li>
</ul>
<pre><code class="language-yaml">jobs:
  build:
    runs-on: ${{ matrix.os }}
    strategy:
      matrix:
        os: [ubuntu-latest, macos-latest, windows-latest]
        rust: [stable, nightly]
    steps:
      - uses: actions/checkout@v4
      - uses: actions/setup-rust@v1
  with:
    rust-version: }
      - run: cargo build --release
</code></pre>
<hr />
<h2 id="release-automation"><a class="header" href="#release-automation">Release Automation</a></h2>
<ul>
<li>Version bump and changelog generation via semantic-release or PR labels</li>
<li>SBOM (<code>bom.json</code>) updated in CI</li>
<li>Artifacts signed with GPG in CI</li>
<li>Publish to GitHub Releases, DockerHub, crates.io as appropriate</li>
</ul>
<hr />
<h2 id="rollback--hotfix-workflow"><a class="header" href="#rollback--hotfix-workflow">Rollback &amp; Hotfix Workflow</a></h2>
<ul>
<li>To rollback: redeploy previous Git tag or release artifact</li>
<li>Hotfix: branch from last tag, patch, CI run, sign, redeploy, update changelog</li>
</ul>
<hr />
<h2 id="troubleshooting-2"><a class="header" href="#troubleshooting-2">Troubleshooting</a></h2>
<ul>
<li>See <a href="release-engineering/../../developer-extensibility-docs/dev-setup.html#troubleshooting">Developer Setup</a> for common issues.</li>
<li>For toolchain issues, refer to <a href="release-engineering/../toolchain.html#troubleshooting#troubleshooting">Toolchain</a>.</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="stack-composer--public-roadmap"><a class="header" href="#stack-composer--public-roadmap">Stack Composer — Public Roadmap</a></h1>
<hr />
<h2 id="1--releasecadence-principles"><a class="header" href="#1--releasecadence-principles">1  Release‑cadence Principles</a></h2>
<ul>
<li><strong>Sprint‑driven cadence, feature‑boxed versions</strong>
<ul>
<li>We operate on <strong>two‑week sprints</strong> (10 working days).</li>
<li>Minor versions ship <strong>every two sprints</strong>; majors only when a public API
breaks or a new distribution channel is added. Semantic‑ver rules apply.</li>
</ul>
</li>
<li><strong>Source‑available first, notarised later.</strong> macOS/Windows signing is added at
<strong>v 1.0</strong> per Tauri notarisation guide to avoid early friction.</li>
<li><strong>Each release must pass</strong> Axe a11y, dep‑scan CVSS ≥ 7 block, OTLP
trace‑export smoke‑test.</li>
<li>Changelogs follow <em>Keep a Changelog</em> spec and list semantic version &amp; sprint
numbers.</li>
</ul>
<hr />
<h2 id="2--sprintbased-milestone-timeline"><a class="header" href="#2--sprintbased-milestone-timeline">2  Sprint‑based Milestone Timeline</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Version</th><th>Sprint Window</th><th>Status</th><th>Themes</th><th>Exit Criteria</th></tr></thead><tbody>
<tr><td><strong>0.5 (MVP)</strong></td><td>S‑01 → S‑04</td><td>🔄 In dev</td><td>Hybrid RAG, Tauri GUI, CLI parity</td><td><em>Quick Start passes on macOS, Win, Linux; plan export JSON validated.</em></td></tr>
<tr><td><strong>0.8</strong></td><td>S‑05 → S‑08</td><td>⏳ Planned</td><td>Signed WASI registry (OCI), RL‑Critic v0</td><td><em>Registry CLI push/pull; critic value within ±10 % of heuristic mean.</em></td></tr>
<tr><td><strong>1.0</strong></td><td>S‑09 → S‑12</td><td>⏳ Planned</td><td>Code‑sign &amp; notarise, auto‑update, installer matrix</td><td><em>DMG notarised, MSI signed, AppImage checksum in CI; Axe score ≥ 90.</em></td></tr>
<tr><td><strong>1.1</strong></td><td>S‑13 → S‑14</td><td>⏳ Planned</td><td>Marketplace UI, Homebrew/Scoop, telemetry dashboard</td><td><em>In‑app plugin browse + install; OTLP traces in Grafana.</em></td></tr>
<tr><td><strong>1.2</strong></td><td>S‑15 → S‑16</td><td>⏳ Planned</td><td>HTN planner adapter (JSHOP‑2), cost metric v2</td><td><em>Plans with durative + HTN validated against test corpus.</em></td></tr>
<tr><td><strong>2.0</strong></td><td>S‑17 → S‑22</td><td>⏳ Vision</td><td>GraphRAG, Tauri‑Mobile, PWA, CRDT collab</td><td><em>Mobile beta on iOS/Android; real‑time multi‑cursor in Fluid.</em></td></tr>
</tbody></table>
</div>
<p><em>A “Sprint Window” is inclusive; e.g., <strong>S‑01 → S‑04</strong> means the feature must be
“done” (code merged &amp; docs updated) by the end of Sprint 4.</em></p>
<blockquote>
<p><strong>Slip rule:</strong> if a feature moves more than <strong>two sprints</strong> forward, an ADR
addendum is required explaining scope or estimate changes.</p>
</blockquote>
<hr />
<h2 id="3--documentation-maturity-alignment"><a class="header" href="#3--documentation-maturity-alignment">3  Documentation Maturity Alignment</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Sprint Range</th><th>Docs Gate</th></tr></thead><tbody>
<tr><td>S‑01 → S‑02</td><td>Quick‑Start, Arch‑Overview, Component stubs</td></tr>
<tr><td>S‑03 → S‑04</td><td>Install guide, RAG &amp; Planner docs, Plugin SDK</td></tr>
<tr><td>S‑05 → S‑08</td><td>Security policy, Telemetry policy, full ADR index</td></tr>
<tr><td>S‑09 → S‑12</td><td>Operations handbook, Marketplace user guide</td></tr>
<tr><td>S‑17 → S‑20</td><td>Mobile client docs, CRDT collaboration guide</td></tr>
</tbody></table>
</div>
<hr />
<h2 id="4--security--compliance-gates"><a class="header" href="#4--security--compliance-gates">4  Security &amp; Compliance Gates</a></h2>
<ul>
<li><strong>CVEs</strong> — dep‑scan &amp; cve‑bin‑tool must show no HIGH/CRITICAL open issues.</li>
<li><strong>Licence audit</strong> — GPL/AGPL flagged; block if dependency—not plugin—requires.</li>
<li><strong>SBOM</strong> generated on each release artefact.</li>
</ul>
<hr />
<h2 id="5--endoflife-policy"><a class="header" href="#5--endoflife-policy">5  End‑of‑Life Policy</a></h2>
<p>Minor releases receive security patches for <strong>9 months</strong>; majors for
<strong>18 months</strong>. Older versions remain visible in Git tags for transparency.</p>
<hr />
<h2 id="6--feedback--changemanagement"><a class="header" href="#6--feedback--changemanagement">6  Feedback &amp; Change‑Management</a></h2>
<ul>
<li>Feature requests via GitHub Discussions; roadmap reviewed every sprint
retrospective.</li>
<li>ADR updates may be submitted with feature PRs; batched commits permitted.</li>
</ul>
<hr />
<h2 id="7--next-actions-sprint-1--s01"><a class="header" href="#7--next-actions-sprint-1--s01">7  Next Actions (Sprint 1 – S‑01)</a></h2>
<ol>
<li>Finalise MVP tickets <code>#76–#110</code>.</li>
<li>Land Dev‑Container + bootstrap justfile.</li>
<li>Commit ADR‑002: Release cadence &amp; EoL policy.</li>
</ol>
<div style="break-before: page; page-break-before: always;"></div><h1 id="community--contribution"><a class="header" href="#community--contribution">Community &amp; Contribution</a></h1>
<p>Get involved with Stack Composer! Learn how to contribute, follow our code of conduct, and join the community.</p>
<h2 id="section-structure-3"><a class="header" href="#section-structure-3">Section Structure</a></h2>
<pre><code class="language-mermaid">flowchart TD
  A[Community &amp; Contribution] --&gt; B[Contributing]
  A --&gt; C[Contributing to Docs]
  A --&gt; D[Code of Conduct]
  A --&gt; E[Governance]
</code></pre>
<h2 id="key-guides-3"><a class="header" href="#key-guides-3">Key Guides</a></h2>
<ul>
<li><a href="contributing/../contributing/contributing.html">Contributing</a>: How to contribute code or ideas.</li>
<li><a href="contributing/how-to-contribute-docs.html">Contributing to Docs</a>: Improve our documentation.</li>
<li><a href="contributing/code-of-conduct.html">Code of Conduct</a>: Community standards.</li>
<li><a href="contributing/MAINTAINERS.html">Governance</a>: Project governance and maintainers.</li>
</ul>
<hr />
<p>{% include "../../_includes/top-doc-contributors.md" %}</p>
<hr />
<p><strong>Next Steps:</strong></p>
<ul>
<li>Explore <a href="contributing/../configuration.html">User Guides</a> to get started.</li>
<li>Learn about <a href="contributing/../plugin-sdk/README.html">Extensibility</a> to build plugins.</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><!-- Top Doc Contributors snippet for reuse across docs -->
<h1 id="top-documentation-contributors"><a class="header" href="#top-documentation-contributors">Top Documentation Contributors</a></h1>
<p>We recognize and thank the following individuals for their outstanding contributions to Stack Composer documentation:</p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>GitHub Username</th><th>Notable Contributions</th></tr></thead><tbody>
<tr><td>Jonathan Botha</td><td>@IAmJonoBo</td><td>Initial architecture, ADRs</td></tr>
<tr><td>[Add more here]</td><td></td><td></td></tr>
</tbody></table>
</div>
<p><em>Want to be listed? Contribute to our docs and open a PR!</em></p>
<p>See <a href="../_includes/../src/contributing/contributing.html">Contributing</a> for how to get involved.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="how-to-contribute-to-documentation"><a class="header" href="#how-to-contribute-to-documentation">How to Contribute to Documentation</a></h1>
<p>We welcome contributions to Stack Composer docs!</p>
<h2 id="guidelines"><a class="header" href="#guidelines">Guidelines</a></h2>
<ul>
<li>Edit or add files in <code>docs/src/</code>.</li>
<li>Use clear, concise language and follow the existing style.</li>
<li>Use kebab-case for file and folder names.</li>
<li>Update <code>SUMMARY.md</code> for navigation.</li>
<li>Preview changes locally with <code>mdbook build</code>.</li>
</ul>
<h2 id="submitting-changes"><a class="header" href="#submitting-changes">Submitting Changes</a></h2>
<ol>
<li>Fork the repo and create a branch.</li>
<li>Make your changes and commit with a descriptive message.</li>
<li>Open a pull request and describe your changes.</li>
<li>A maintainer will review and merge.</li>
</ol>
<h2 id="resources"><a class="header" href="#resources">Resources</a></h2>
<ul>
<li><a href="contributing/contributing.html">Contributing Guide</a></li>
<li><a href="contributing/code-of-conduct.html">Code of Conduct</a></li>
</ul>
<p>Thank you for helping improve the docs!</p>
<hr />
<p>See also: <a href="contributing/../../_includes/top-doc-contributors.html">Top Doc Contributors</a></p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="contributing-to-stack-composer"><a class="header" href="#contributing-to-stack-composer">Contributing to Stack Composer</a></h1>
<blockquote>
<p><strong>Note:</strong> All JavaScript/TypeScript package management uses <strong>pnpm</strong> by default. Use <strong>Yarn</strong> only for edge cases (see main README).</p>
</blockquote>
<p>{% include "../../_includes/contribution-steps.md" %}</p>
<hr />
<h2 id="developer-environment"><a class="header" href="#developer-environment">Developer Environment</a></h2>
<p>For a reproducible, fast, and modern developer experience, use the pre-configured Dev Container or Nix environment. See <a href="contributing/../toolchain.html">Toolchain &amp; DX Pipeline</a> for the full toolchain and workflow details.</p>
<h3 id="toolchain-checklist"><a class="header" href="#toolchain-checklist">Toolchain Checklist</a></h3>
<ul>
<li>
<p>All required tools (see <a href="contributing/../developer-extensibility-docs/dev-setup.html">dev-setup</a> and <a href="contributing/../toolchain.html">toolchain</a>) are installed</p>
</li>
<li>
<p>Qdrant is running via Docker</p>
</li>
<li>
<p>Nix is available (restart terminal after install)</p>
</li>
<li>
<p>Mutagen is a Rust library, not a CLI tool</p>
</li>
<li>
<p>Run <code>just bootstrap</code> to set up all dependencies and services</p>
</li>
<li>
<p>Use <code>just check</code> and <code>just test</code> for linting and tests</p>
</li>
<li>
<p>See <a href="contributing/../developer-extensibility-docs/dev-setup.html">Developer Setup</a> for step-by-step onboarding</p>
</li>
</ul>
<blockquote>
<p>If you have issues with Nix, Docker, or any tool, see the troubleshooting sections in <a href="contributing/../developer-extensibility-docs/dev-setup.html">dev-setup</a> or open an issue.</p>
</blockquote>
<h3 id="macos-specific-setup"><a class="header" href="#macos-specific-setup">macOS-Specific Setup</a></h3>
<p>⚠️ <strong>macOS developers must follow these additional steps</strong> due to resource fork file issues with Tauri builds:</p>
<ol>
<li>
<p><strong>Set environment variables</strong> (add to your shell profile):</p>
<pre><code class="language-bash">export COPYFILE_DISABLE=1
export COPY_EXTENDED_ATTRIBUTES_DISABLE=1
</code></pre>
</li>
<li>
<p><strong>Use platform-specific build commands</strong>:</p>
<pre><code class="language-bash"># Regular development (all packages except Tauri)
cargo check --workspace
cargo build --workspace

# Tauri development
./build-tauri.sh
</code></pre>
</li>
<li>
<p><strong>Read the full troubleshooting guide</strong>: <a href="contributing/../../MACOS_BUILD_ISSUES.html">macOS Build Issues</a></p>
</li>
</ol>
<p><strong>Why?</strong> macOS creates resource fork files (<code>._*</code>) that cause Tauri's build script to fail with UTF-8 errors. The workspace excludes Tauri by default to prevent blocking regular development.</p>
<hr />
<h2 id="code-quality--linting-workflow"><a class="header" href="#code-quality--linting-workflow">Code Quality &amp; Linting Workflow</a></h2>
<p>All linting, formatting, and code quality checks are orchestrated by <strong>Trunk</strong>. This ensures maximum synergy and minimal duplication between Biome, ESLint (unicorn), Prettier, Stylelint, HTMLHint, Markdownlint, Vale, and other tools.</p>
<ul>
<li><strong>Run <code>trunk check</code> locally before pushing or opening a PR.</strong> This will run all configured linters, formatters, and code quality tools in a single pass.</li>
<li>The CI pipeline enforces <code>trunk check</code> as the main code quality gate. PRs will not pass unless all Trunk checks succeed.</li>
<li>Individual linter scripts (e.g., <code>biome check</code>, <code>eslint</code>, <code>prettier</code>, etc.) are deprecated in favor of Trunk orchestration.</li>
<li>To add or modify code quality tools, update <code>.trunk/trunk.yaml</code> and test with <code>trunk check</code>.</li>
<li>For more details, see <a href="https://docs.trunk.io/cli">Trunk documentation</a> and the project <code>.trunk/trunk.yaml</code>.</li>
</ul>
<hr />
<h2 id="pull-request--review-process"><a class="header" href="#pull-request--review-process">Pull Request &amp; Review Process</a></h2>
<ol>
<li>Fork the repo and create a feature branch.</li>
<li>Make your changes and add/expand tests and documentation as needed.</li>
<li>If your change impacts architecture or public APIs, propose an ADR (see below).</li>
<li>Open a PR; at least one maintainer must review and approve.</li>
<li>All PRs must pass CI, lint, and test checks before merge.</li>
<li>Major changes are discussed in GitHub Discussions or community meetings.</li>
</ol>
<hr />
<h2 id="docs-required-in-prs"><a class="header" href="#docs-required-in-prs">Docs Required in PRs</a></h2>
<p>All user-facing or architectural changes <strong>must</strong> include documentation updates. PRs without docs will not be merged. See the PR template for details.</p>
<hr />
<h2 id="adr-workflow--decision-logging"><a class="header" href="#adr-workflow--decision-logging">ADR Workflow &amp; Decision Logging</a></h2>
<ul>
<li>Propose new ADRs in <code>/docs/src/architecture/adr/</code> using the template.</li>
<li>Each ADR must include a title, date, status, and rationale.</li>
<li>Update the <a href="contributing/../architecture/adr/README.html">ADR log</a> with each new ADR.</li>
</ul>
<hr />
<h2 id="community-guidelines"><a class="header" href="#community-guidelines">Community Guidelines</a></h2>
<ul>
<li>All contributors must follow the <a href="contributing/code-of-conduct.html">Code of Conduct</a>.</li>
<li>Communication is primarily via GitHub Discussions; real-time chat is available via Slack/Discord (see README).</li>
<li>Quarterly community meetings are open to all; notes are posted in Discussions.</li>
</ul>
<hr />
<h2 id="maintainers--governance"><a class="header" href="#maintainers--governance">Maintainers &amp; Governance</a></h2>
<ul>
<li>See <a href="contributing/MAINTAINERS.html">MAINTAINERS.md</a> for roles, triage rotation, and how to become a maintainer.</li>
</ul>
<hr />
<p>{% include "../../_includes/top-doc-contributors.md" %}</p>
<hr />
<p><strong>Next Steps:</strong></p>
<ul>
<li>See <a href="contributing/how-to-contribute-docs.html">Contributing to Docs</a></li>
<li>Review <a href="contributing/code-of-conduct.html">Code of Conduct</a></li>
<li>Explore <a href="contributing/README.html">Community &amp; Contribution Overview</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="code-of-conduct"><a class="header" href="#code-of-conduct">Code of Conduct</a></h1>
<p>All contributors, maintainers, and community members are expected to:</p>
<ul>
<li>Be respectful and inclusive in all interactions.</li>
<li>Provide constructive feedback and support newcomers.</li>
<li>Avoid personal attacks, harassment, or discriminatory language.</li>
<li>Report violations to the maintainers via GitHub Issues or private email.</li>
</ul>
<h2 id="enforcement"><a class="header" href="#enforcement">Enforcement</a></h2>
<ul>
<li>Reports are reviewed by maintainers within 48 hours.</li>
<li>Actions may include warning, temporary ban, or permanent removal from the community, depending on severity.</li>
<li>Appeals can be made via GitHub Discussions or by contacting a maintainer directly.</li>
</ul>
<hr />
<p>See also: <a href="contributing/../../_includes/top-doc-contributors.html">Top Doc Contributors</a></p>
<hr />
<p>For questions or concerns, contact a maintainer (see <a href="contributing/MAINTAINERS.html">MAINTAINERS.md</a>).</p>
<hr />
<p><strong>Next Steps:</strong></p>
<ul>
<li>See <a href="contributing/README.html">Community &amp; Contribution Overview</a></li>
<li>Review <a href="contributing/CONTRIBUTING.html">Contributing</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="maintainers"><a class="header" href="#maintainers">Maintainers</a></h1>
<p>The following people are responsible for the ongoing maintenance, review, and stewardship of the Stack Composer project. For questions, issues, or contributions, please contact a maintainer below.</p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>GitHub Username</th><th>Role</th></tr></thead><tbody>
<tr><td>Jonathan Botha</td><td>@IAmJonoBo</td><td>Lead Maintainer</td></tr>
<tr><td>[Add more here]</td><td></td><td></td></tr>
</tbody></table>
</div>
<h2 id="responsibilities-3"><a class="header" href="#responsibilities-3">Responsibilities</a></h2>
<ul>
<li>Review and merge pull requests</li>
<li>Triage issues and feature requests</li>
<li>Oversee releases and CI/CD</li>
<li>Ensure code quality and documentation standards</li>
<li>Respond to security and vulnerability reports</li>
</ul>
<p>For more information, see the <a href="contributing/contributing.html">Contributing Guide</a> and <a href="contributing/code-of-conduct.html">Code of Conduct</a>.</p>
<hr />
<p>See also: <a href="contributing/../../_includes/top-doc-contributors.html">Top Doc Contributors</a></p>
<div style="break-before: page; page-break-before: always;"></div><hr />
<h2 id="title-trunk-cli--lint--format"><a class="header" href="#title-trunk-cli--lint--format">title: Trunk CLI — Lint &amp; Format</a></h2>
<h1 id="trunk-cli--local-usage--troubleshooting"><a class="header" href="#trunk-cli--local-usage--troubleshooting">Trunk CLI — local usage &amp; troubleshooting</a></h1>
<p>We run our linters via Trunk for a single entrypoint across languages. Locally we
prefer fast, Node-based tools to avoid heavy native downloads; CI runs the full
matrix.</p>
<h2 id="local-commands"><a class="header" href="#local-commands">Local commands</a></h2>
<ul>
<li>Fast check (local):
<ul>
<li>scripts/trunk-check.sh</li>
</ul>
</li>
<li>Full reset if it hangs:
<ul>
<li>scripts/trunk-reset.sh</li>
</ul>
</li>
</ul>
<h2 id="what-runs-locally"><a class="header" href="#what-runs-locally">What runs locally</a></h2>
<ul>
<li>biome (TS/JS formatter+lint)</li>
<li>markdownlint-cli2 (docs)</li>
<li>git-diff-check (no large/binary diffs)</li>
</ul>
<p>Native tools (actionlint, taplo, shellcheck, shfmt, yamllint) run in CI via
<code>pnpm run lint:trunk</code>.</p>
<h2 id="troubleshooting-3"><a class="header" href="#troubleshooting-3">Troubleshooting</a></h2>
<ul>
<li>Symptom: trunk check shows 0% and never advances
<ul>
<li>Fix: run scripts/trunk-reset.sh, then retry scripts/trunk-check.sh</li>
</ul>
</li>
<li>Symptom: JSON parse errors on package.json/tsconfig.json
<ul>
<li>Fix: look for merge conflict markers (&lt;&lt;&lt;&lt;&lt;&lt;&lt;, =======, &gt;&gt;&gt;&gt;&gt;&gt;&gt;) and resolve</li>
</ul>
</li>
<li>Symptom: “Binary not found” for native linters
<ul>
<li>Fix: ignore locally; CI runs those. Or install manually and add to PATH.</li>
</ul>
</li>
</ul>
<h2 id="ci-usage"><a class="header" href="#ci-usage">CI usage</a></h2>
<p>The root package.json includes "lint:trunk" which runs the native tool subset in
non-interactive mode with no progress UI. See .trunk/trunk.yaml for the list of
enabled linters.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="glossary"><a class="header" href="#glossary">Glossary</a></h1>
<blockquote>
<p><strong>Purpose</strong> — a single page that decodes every acronym, protocol, and buzz‑term
you will meet while working on <strong>Stack Composer</strong>. Terms are listed
alphabetically. Feel free to append as new concepts land.</p>
</blockquote>
<hr />
<h2 id="a"><a class="header" href="#a">A</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Term</th><th>Meaning</th></tr></thead><tbody>
<tr><td><strong>ADR</strong></td><td><em>Architecture Decision Record</em> – a lightweight Markdown file capturing the context, decision, and consequences of a technical choice.</td></tr>
<tr><td><strong>AHP</strong></td><td><em>Analytic Hierarchy Process</em> – multi‑criteria decision‑making method used by the Stack Agent to weight licence, maturity, performance, etc.</td></tr>
<tr><td><strong>API</strong></td><td><em>Application Programming Interface</em> – a contract that lets two programs talk (gRPC, REST, CLI).</td></tr>
<tr><td><strong>AppImage</strong></td><td>Portable Linux packaging format used for Stack Composer’s manual installer.</td></tr>
</tbody></table>
</div>
<h2 id="b"><a class="header" href="#b">B</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Term</th><th>Meaning</th></tr></thead><tbody>
<tr><td><strong>BM25</strong></td><td>Ranking function for full‑text search, implemented by Meilisearch.</td></tr>
<tr><td><strong>Borda Count</strong></td><td>Voting system; the Retrieval Layer’s RRF fusion is a Borda‑like method.</td></tr>
</tbody></table>
</div>
<h2 id="c"><a class="header" href="#c">C</a></h2>
<p>| <strong>Cap Token</strong> | JSON blob listing capabilities granted to a WASI plugin (e.g. <code>["log","retrieval"]</code>). |
| <strong>CI/CD</strong> | <em>Continuous Integration / Continuous Deployment</em> – automated build and release pipeline. |
| <strong>CLI</strong> | <em>Command‑Line Interface</em> – <code>stack‑composer ingest brief.md</code>. |
| <strong>CRDT</strong> | <em>Conflict‑free Replicated Data Type</em> – algorithm for real‑time collaboration (Fluid Framework). |
| <strong>CVE</strong> | <em>Common Vulnerabilities &amp; Exposures</em> – ID for a published security flaw. |
| <strong>CVSS</strong> | <em>Common Vulnerability Scoring System</em> – 0‑10 severity score used by dep‑scan. |</p>
<h2 id="d"><a class="header" href="#d">D</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Term</th><th>Meaning</th></tr></thead><tbody>
<tr><td><strong>Dag</strong></td><td><em>Directed Acyclic Graph</em> – layout algorithm (Dagre) for dependency graphs.</td></tr>
<tr><td><strong>DevContainer</strong></td><td>VS Code JSON file that spins up Dockerised dev environments.</td></tr>
<tr><td><strong>Dockerfile</strong></td><td>Script that builds a container image; generated in the starter scaffold.</td></tr>
<tr><td><strong>DRY</strong></td><td><em>Don’t Repeat Yourself</em> – software engineering principle; enforced by lint rules.</td></tr>
</tbody></table>
</div>
<h2 id="f"><a class="header" href="#f">F</a></h2>
<p>| <strong>Fast Downward</strong> | GPL‑exception PDDL planner bundled as a subprocess. |
| <strong>Fuel Metering</strong> | Wasmtime feature that counts Wasm instructions to stop runaway plugins. |</p>
<h2 id="g"><a class="header" href="#g">G</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Term</th><th>Meaning</th></tr></thead><tbody>
<tr><td><strong>Gantt Chart</strong></td><td>Bar‑style timeline; UI renders plan steps when OPTIC returns start/end times.</td></tr>
<tr><td><strong>GGUF</strong></td><td><em>GPT‑NeoX General‑Format</em> file that stores quantised LLM weights (used by Ollama).</td></tr>
<tr><td><strong>GPL</strong></td><td><em>GNU Public Licence</em> – copyleft licence; blocked by default in permissive mode.</td></tr>
<tr><td><strong>gRPC</strong></td><td>High‑performance RPC protocol used between Tauri UI and orchestrator.</td></tr>
</tbody></table>
</div>
<h2 id="h"><a class="header" href="#h">H</a></h2>
<p>| <strong>HNSW</strong> | <em>Hierarchical Navigable Small World</em> – graph index that powers fast vector search in Qdrant. |
| <strong>HTN</strong> | <em>Hierarchical Task Network</em> planner; JSHOP‑2 adapter is on the roadmap. |</p>
<h2 id="j"><a class="header" href="#j">J</a></h2>
<p>| <strong>JSONL</strong> | <em>JSON Lines</em> – newline‑delimited JSON; format used by local telemetry trace files. |</p>
<h2 id="l"><a class="header" href="#l">L</a></h2>
<p>| <strong>LLM</strong> | <em>Large Language Model</em> – neural network that generates and embeds text (phi‑3, llama‑3, etc.). |
| <strong>Lingui</strong> | i18n extraction and runtime library chosen for React UI localisation. |
| <strong>LM Studio</strong> | Desktop app that hosts local LLMs; probed by model‑detection routine. |</p>
<h2 id="m"><a class="header" href="#m">M</a></h2>
<p>| <strong>Meilisearch</strong> | Rust‑written search engine; provides BM25 + hybrid vector ranking. |
| <strong>mdBook</strong> | Rust tool that turns Markdown into a static doc site; powers this documentation. |
| <strong>MCTS</strong> | <em>Monte‑Carlo Tree Search</em> – planning/rl algorithm offered by scikit‑decide. |
| <strong>Marketplace</strong> | In‑app UI for discovering and installing signed WASI plugins. |</p>
<h2 id="n"><a class="header" href="#n">N</a></h2>
<p>| <strong>Nix</strong> | Declarative package manager; optional flake provides reproducible CLI env. |
| <strong>npm</strong> | Node package registry queried by the Ontology Crawler. |</p>
<h2 id="o"><a class="header" href="#o">O</a></h2>
<p>| <strong>OCI</strong> | <em>Open Container Initiative</em> – spec used for the upcoming plugin registry. |
| <strong>Ollama</strong> | Local LLM runtime exposing OpenAI‑style REST endpoints, default provider. |
| <strong>OPTIC</strong> | Temporal/cost PDDL planner; second adapter after Fast Downward. |
| <strong>OpenTelemetry (OTel)</strong> | CNCF observability framework used for spans and metrics. |</p>
<h2 id="p"><a class="header" href="#p">P</a></h2>
<p>| <strong>PDDL</strong> | <em>Planning Domain Definition Language</em> – declarative language consumed by planners. |
| <strong>PPO</strong> | <em>Proximal Policy Optimisation</em> – RL algorithm used by default Border critic. |
| <strong>PII</strong> | <em>Personally Identifiable Information</em> – scrubbed during ingestion and telemetry. |
| <strong>Prometheus</strong> | Metrics backend; optional exporter at <code>/metrics</code>. |</p>
<h2 id="q"><a class="header" href="#q">Q</a></h2>
<p>| <strong>Qdrant</strong> | Embedded vector DB that stores 1 536‑dim sentence embeddings. |
| <strong>Quick‑XML</strong> | Streaming XML parser used by Crawler for RSS feeds. |</p>
<h2 id="r"><a class="header" href="#r">R</a></h2>
<p>| <strong>RAG</strong> | <em>Retrieval‑Augmented Generation</em> – method of grounding LLM output in retrieved facts. |
| <strong>REST</strong> | Representational State Transfer – HTTP API pattern. |
| <strong>RL</strong> | <em>Reinforcement Learning</em> – training paradigm; critic scores stack plans. |
| <strong>RRF</strong> | <em>Reciprocal‑Rank Fusion</em> – merges dense and sparse result lists. |
| <strong>Rustup</strong> | Toolchain installer that pins rustc version. |</p>
<h2 id="s"><a class="header" href="#s">S</a></h2>
<p>| <strong>SBOM</strong> | <em>Software Bill of Materials</em> – list of all dependencies; generated by cargo‑auditable. |
| <strong>SSE</strong> | <em>Server‑Sent Events</em> – streaming transport used by Ollama’s <code>/api/chat</code>. |
| <strong>SHACL</strong> | <em>Shapes Constraint Language</em> – future ontology validation spec. |
| <strong>SQLite WAL</strong> | Write‑Ahead Log mode; chosen for ontology.db concurrency. |
| <strong>Storybook</strong> | UI component explorer with Chromatic snapshots. |</p>
<h2 id="t"><a class="header" href="#t">T</a></h2>
<p>| <strong>Tauri</strong> | Rust‑based framework for building small desktop apps; wraps the React UI. |
| <strong>Tera</strong> | Template engine used for the Markdown report generator. |
| <strong>Trivy</strong> | Container and SBOM security scanner in CI. |</p>
<h2 id="v"><a class="header" href="#v">V</a></h2>
<p>| <strong>Vale</strong> | Markdown/style linter enforcing inclusive language. |
| <strong>vLLM</strong> | High‑throughput CUDA inference server compatible with OpenAI API. |</p>
<h2 id="w"><a class="header" href="#w">W</a></h2>
<p>| <strong>WASI</strong> | <em>WebAssembly System Interface</em> – host API standard that enables safe sandboxing. |
| <strong>Wasmtime</strong> | Bytecode Alliance runtine that executes WASI plugins with capability tokens. |
| <strong>Window</strong> | 256 tokens by default: ingestion chunk size with 64‑token overlap. |</p>
<h2 id="y"><a class="header" href="#y">Y</a></h2>
<p>| <strong>YAML</strong> | Human‑friendly superset of JSON; config format for market‑place metadata. |</p>
<hr />
<p><em>If a term is missing, create a pull‑request that appends a table row in the
correct alphabetical section.</em> Happy composing!</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="adr-log"><a class="header" href="#adr-log">ADR Log</a></h1>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->


                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">

            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr.min.js"></script>
        <script src="mark.min.js"></script>
        <script src="searcher.js"></script>

        <script src="clipboard.min.js"></script>
        <script src="highlight.js"></script>
        <script src="book.js"></script>

        <!-- Custom JS scripts -->

        <script>
        window.addEventListener('load', function() {
            window.setTimeout(window.print, 100);
        });
        </script>


    </div>
    </body>
</html>
